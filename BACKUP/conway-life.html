<!DOCTYPE html>
<html>
<!--
Page Timeline:

(11/21/2022):
- Fixed some bugs where the structure preview wouldn't show up after clicking some hotkeys

(11/20/2022):
- Added title text to every single structure preset, with information like pattern type, period, speed, etc.
- Fixed some bugs with a few structures' bounding boxes and initial phases
- Added many new oscillators and spaceships to "Day and Night" structures and "Move" structures
- Added new tab for structures for "Diamoeba"
- Added new tab for structures for "34 Life"
- Also, after adding "Morningstar" to "34 Life", I hit 100 structures!

(11/19/2022):
- Removed the old way of placing structs; before, there were red cells drawn wherever the struct couldn't be placed; e.g., if it was less than half the width from the left side. This makes the grid a lot less ugly when placing a struct, since before it was covered in red rectangles
    - Now, every grid position is a valid placement, and it just pushes the struct to be inside the grid even if the cursor was really close to the edge
	- I also made the "Placing:" text give a red error if the current struct doesn't fit on the canvas
- Changed which phase Steam Train (2x2) was in so that it more accurately represents the size of it, instead of picking its smallest phase
- Added symmetry options for the "Static" shape struct

(11/17/2022):
- Added "Static" shape structure, that randomizes the cells inside the given width/height
    - It also re-randomizes whenever you place it

(11/16/2022):
- Added "Tortoise" and "Scarabs" structures for 2x2
- Added additional text stating currently selected structure above struct-canvas
- Gave Shape Structures additional information (like width, height, etc.) in the "Placing:" and "Selected:" descriptions
- Added "Flock" rule preset
    - Added structure presets for Flock, found on LifeWiki
	- At some point while deciding the name of one spaceship for this rule, I decided on "Artemis," which made me decide to continue the theme of Greek mythology names, so there's now Apollo, Artemis, Kronos, and Hyperion
- Added "(Selected: ___)" text to Cell Rules div, showing currently selected ruleset, or "Custom Rule" if it doesn't match any preset
- Added "Eraser" shape structure, that just clears a set area
- Attempted to add a third fill option for Shape structures, striped, but I couldn't quite get it working right

(11/14/2022):
- Fixed a minor bug where the structure preview would disappear if you paused the simulation while your canvas was still on the screen
- After messing around with the Move ruleset, I discovered two spaceships! I named them Hang Glider and Steam Train, and the latter is even a puffer!
    - Added Move subsection to the Structures tab
	- Added text clarifying that some structures only work in certain rules, and added shortcut buttons to activate those rules
	- I also found that if you place two Hang Gliders with 16 empty cells between them (facing each other), it synthesises a Steam Train!
	- Later I found that if you place two Steam Trains (in the initial state from the structures menu) facing each other with 20 empty cells between them, they'll crash into each other, and when the dust clears the result is two Steam Trains going in opposite directions, and across the other axis! E.g., if they are 20 spaces apart horizontally, then after crashing they'll be driving away from each other vertically.
	    - If they are only 10 apart, they'll crash and start moving away from each other on the *same* axis.
- Added new Oscillator and Spaceship structures under Game of Life
- Added settings for Cell Trailing under the Colors tab, which affects the rate at which the grid clears every step, creating a trailing effect behind cells.
- Added more structures for Game of Life
- Added structures for Day and Night and 2x2
    - I didn't find these myself; I found that LifeWiki has pages for different cellular automata as well, including structures for them

(11/13/2022):
- Added a structCanvas that displays a preview of the currently selected structure, so that you don't have to hover your mouse over the canvas to see what the structure looks like. This is especially helpful when changing settings on shape structures. Clicking this small canvas is the same as pressing the Escape key, and toggles structure placing mode.

(11/6/2022):
- Holy CRAP I spent ages getting the rotation down but...it works now! I literally had to bust out (practically) Group Theory to model the symmetries of a square and how to map between then under various operations. After ages and ages of debugging and rewriting and restructuring code...it finally works, and you can now mirror and rotate any structure to your heart's content (even non-square shapes). The problem wasn't implementing rotating a grid (although that was a big struggle), the main difficulty was mapping between different orientations, so if a user hit ",l,;..;l,.;l" it wouldn't have to step through all of those instructions one-by-one every time, it would just have a set state to draw the structure in. I finally got that working.
- Added buttons in the Structures tab that mirror and rotate the structure
- Formatted hotkey descriptions into two columns so it takes up less vertical space
- Modified all spaceship structures so that they're all facing to the right (or bottom right if they're oblique) so that rotating one will make them all face the same direction still, instead of being in different orientations

(11/5/2022):
- Attempted to add rotation of structures and got bogged down with complicated group theory of symmetries and how rotations interact with mirroring, and I ended up breaking it. I just removed the mirroring functionality (for now) until I can solve this and hopefully get mirroring AND rotation to work

(11/3/2022):
- Added "Museum" rule preset (called this because when randomizing high densities, it tends to create intricate and interesting still lifes, with widely varying sizes and shape. They're also fragile, and adding one cell next to a still life usually causes it to collapse)
- Fixed a bug where drawing cells while the canvas was running wouldn't properly update whether you started on a black or white cell

(11/2/2022):
- Changed Diagonal Line to X and made it two crossing diagonal lines, since one single line tended to make boring patterns
- Fixed a bug I’d had for ages where the top-left pixel of every structure preview would always  be drawn darker, and I could never figure out why
    - I fixed it by hard-coding it to draw a white square underneath the top-left pixel, so it looks normal now, even though I have absolutely no idea why that was even a bug
- Added Cross shape structure
- Added dynamic structure mirroring (through much debugging (and lamenting that strings are immutable in JS))
- Turned hotkey descriptions into a table that generates on initHTML() so it can be more nicely formatted

(11/1/2022):
- Changed how the grid resizes so that it saves the current grid state and centers it
    - Now changing the grid size doesn't clear what you currently have, but replaces it in the center
- Now a random structure is placed when the page is reloaded, instead of just randomizing the grid
- Added Twirling T-Tetsons II structure
- Added Diagonal Line shape structure

(10/26/2022):
- Finally added support for Rectangle Shape Structures
- Added settings for Shape Structure Dimensions

(10/25/2022):
- Fixed a bug where the structure preview would be left on the canvas if you moved your cursor off the canvas
- Added hotkeys for clearing and randomizing the grid, and for stepping one tick
- Added Pööpenfärten as discovered and named by David French
- Added "Placing:" text to show currently selected structure
- Added Kok's Galaxy
- Added UI to make the canvas's outline black when Wrap Grid Edges is false
- This is officially the 14th day in a row I've worked on this project, from the very beginning

(10/24/2022):
- Fixed a bug where the structure preview would sometimes still be shown immediately after placing, instead of being hidden until the mouse moves

(10/23/2022):
- Added hotkeys for structure placing, pausing, and resetting

(10/22/2022):
- Added top-canvas above canvas
- Made structure previews and grid lines draw on top-canvas, so that previewing a structure doesn't need to redraw thousands of cells and is much less laggy now

(10/21/2022):
- Added function to convert .rle files to the format I use for structures
- Added more structures

(10/20/2022):
- Added Spacefillers structures subsection
- Added Glider Synthesis structures subsection
- Made it so that resizing the grid clears it, instead of randomizing it

(10/19/2022):
- Added more Game of Life structures

(10/18/2022):
- Changed CSS button styles
- Commented all code
- Added code for two different sections on the rightmost <td>
- Added structures, you can enter Placing Mode and copy preset designs onto the grid

(10/17/2022):
- Added more rule presets
- Added a Reset button to revert to the last edited grid state

(10/16/2022):
- Added rule presets and more settings

(10/15/2022):
- Added more settings and improved performance when drawing cells

(10/14/2022):
- More CSS design changes
- Added census information
- Added grid lines and cell rules

(10/13/2022):
- Page created, as a more updated version of life.html
- Added page wrap and base HTML and rule settings
-->
  <head>
    <meta charset = "utf-8">
    <meta name = "viewport" content = "width = device-width, initial-scale = 1.0">
    <link rel = "icon" href = "images/favicon.png" type = "image/png">
    <link rel = "stylesheet" href = "stylesheets/main.css">
    <link rel = "stylesheet" href = "stylesheets/page.css">
    <title>Conway's Game of Life ~ e4494s</title>
    <style>
      canvas, #canvas, #top-canvas {
        border: none;
        outline: none;
      }
      #canvas {
        outline: 2px solid rgb(200, 200, 200);
        z-index: -1;
      }
      #top-canvas {
        position: absolute;
        left: 0;
        top: 0;
        z-index: 1;
        width: 400px;
        height: 400px;
      }
      #canvas-div {
        position: relative;
        outline: none;
        border: none;
      }
      
      .preset-btn, .active-preset-btn {
        padding-left: 5px;
        padding-right: 5px;
        padding-top: 1px;
        padding-bottom: 1px;
      }
      
      button {
        font-size: 15px;
        font-style: italic;
        padding-top: 5px;
        padding-bottom: 5px;
        border-radius: 15px;
        border: 6px double #ff9500; /* Accent color */
        color: #cc7700; /* Dark accent color */
      }
      
      .normal-btn {
        font-weight: bold;
        border-width: 6px;
        border-color: #ff9500; /* Accent color */
        border-style: double dashed double dashed;
        border-radius: 0;
        background-color: white;
        padding: 2px 5px 2px 5px;
        font-size: initial;
        color: black;
        font-style: normal;
      }
      .normal-btn:hover {
        background-color: #ffd599; /* Light accent color */
      }
      .normal-btn:active {
        background-color: #ffbf66; /* Medium light accent color */
      }
      
      .download-canvas-btn {
        color: blue;
      }
      
      .padded-div {
        padding-left: 6px;
        padding-right: 6px;
      }
      
      .colored-div {
        padding: 5px;
        border-radius: 20px;
        background-color: #fdf28b; /* Light yellow */
        border: 2px solid black;
        display: inline-block;
      }
      
      .small-title {
        font-weight: bold;
        font-style: italic;
        font-size: 20px;
        text-align: center;
      }
      
      input[type=checkbox] {
        margin: 0;
      }
      
      .rule-label {
        padding-left: 6px;
        padding-right: 6px;
        padding-top: 3px;
        padding-bottom: 3px;
        margin-top: 3px;
        margin-bottom: 3px;
        text-align: center;
        border: none;
        cursor: pointer;
      }
      .rule-label:hover {
        outline: 1px solid black;
      }
      .rule-label:active {
        outline: 2px solid black;
      }
      
      #fps-range {
        width: 180px;
      }
      
      input[type=range] {
        width: 120px;
      }
      
      .reset-btn-active {
        background-color: black;
        color: white;
        border: 6px double rgb(120, 120, 255);
      }
      .reset-btn-active:hover {
        background-color: rgb(80, 80, 80);
      }
      .reset-btn-active:active {
        background-color: rgb(120, 120, 120);
      }
      
      .running-btn, .paused-btn {
        background-color: white;
        width: 130px;
      }
      
      .running-btn {
        border: 6px double green;
        color: green;
      }
      .running-btn:hover {
        background-color: #66ff66; /* Light green */
      }
      .running-btn:active {
        background-color: #00cc00; /* Green */
      }
      
      .paused-btn {
        border: 6px double red;
        color: red;
      }
      .paused-btn:hover {
        background-color: #ffb3b3; /* Light red */
      }
      .paused-btn:active {
        background-color: #ff6666; /* Red */
      }
      
      .step-btn-active, .step-btn-inactive {
        background-color: white;
      }
      
      .step-btn-active {
        border: 6px double black;
        color: black;
        cursor: pointer;
      }
      .step-btn-active:hover {
        background-color: #999999; /* Light gray */
      }
      .step-btn-active:active {
        background-color: #808080; /* Gray */
      }
      
      .step-btn-inactive, .step-btn-inactive:hover, .step-btn-inactive:active, .reset-btn-inactive, .reset-btn-inactive:hover, .reset-btn-inactive:active {
        border: 6px double #999999;
        background-color: white;
        color: #999999;
        cursor: default;
      }
      
      .census-td {
        padding: 10px;
        min-width: 0;
      }
      .census-txt {
        font-size: 17px;
        font-weight: bold;
      }
      
      label, input[type=checkbox] {
        cursor: pointer;
      }
      
      .slightly-larger-txt {
        font-style: italic;
        font-size: 15px;
      }
      
      .active-preset-btn, .active-preset-btn:hover, .active-preset-btn:active {
        font-style: italic;
        font-weight: normal;
        font-size: 12px;
        border-width: 4px;
        border-style: double hidden double hidden;
        margin: 5px;
        border-radius: 12px;
        background-color: #ffbf66; /* Medium light accent color */
        cursor: default;
      }
      
      .rule-preset-title {
        font-size: 15px;
        font-weight: bold;
        text-align: center;
      }
      
      .rule-preset-div {
        margin: 5px;
        border: 2px solid gray;
        border-radius: 15px;
        padding: 5px;
        background-color: lightgray;
      }
      
      .section-btn-inactive, .section-btn-active {
        padding: 3px 6px 3px 6px;
        border: 2px solid black;
        color: black;
        font-size: 15px;
        font-style: normal;
        cursor: pointer;
        margin: 3px;
      }
      
      .section-btn-active, .section-btn-active:hover, .section-btn-active:active {
        background-color: rgb(110, 110, 0);
        cursor: default;
      }
      
      .section-btn-inactive {
        background-color: rgb(255, 255, 100);
        cursor: pointer;
      }
      .section-btn-inactive:hover {
        background-color: rgb(150, 150, 50);
      }
      .section-btn-inactive:active {
        background-color: rgb(110, 110, 0);
      }
      
      .structure-btn-inactive, .structure-btn-active {
        font-size: 12px;
        font-style: normal;
        padding: 2px 4px 2px 4px;
        color: black;
        border: 2px solid black;
        cursor: pointer;
        border-radius: 0;
        margin: 3px;
      }
      .structure-btn-inactive:hover {
        background-color: lightgray;
      }
      .structure-btn-inactive:active {
        background-color: gray;
      }
      
      .structure-btn-active, .structure-btn-active:hover, .structure-btn-active:active {
        background-color: gray;
      }
      
      .little-font {
        font-size: 11px;
        color: dimgray;
        font-style: italic;
      }
      
      .smaller-btn {
        margin-top: 5px;
        padding: 2px 5px 2px 5px;
        border: 2px solid black;
        font-size: 11px;
        color: black;
        font-style: normal;
        background-color: white;
        font-weight: normal;
      }
      .smaller-btn:hover {
        background-color: lightgray;
      }
      .smaller-btn:active {
        background-color: gray;
      }
      
      .shape-property-div {
        margin-top: 20px;
        margin-bottom: 20px;
      }
      
      .hotkey-txt {
        font-weight: bold;
        font-style: normal;
        font-size: 15px;
        padding-right: 10px;
      }
	  
	  #struct-canvas {
		width: 150px;
		height: 150px;
		cursor: pointer;
		margin: 6px;
	  }
	  
	  #struct-desc-txt-wrapper {
	    font-weight: bold;
		font-style: italic;
		font-size: 11px;
		color: rgb(80, 80, 80);
		text-align: center;
	  }
	  
	  #curr-rule-txt {
	    font-weight: bold;
		font-style: italic;
		font-size: 11px;
		text-align: center;
		margin-top: 5px;
		margin-bottom: 5px;
	  }
    </style>
  </head>
<body onload = "initHTML()">
<a id = "top-title" href = "https://e4494s.neocities.org" target = "_blank"></a>
<h1>&mdash;&mdash; Conway's Game of Life &mdash;&mdash;</h1>
<div id = "how-it-works">
  <b><i>How It Works:</i></b> The Game of Life is a 2D cellular automata created by John Conway. It consists of a simple grid of cells, each either <i>on</i> or <i>off</i>. Every step, three rules are followed: (1) Any live cell with 2 or 3 neighbors survives, (2) any dead cell with exactly 3 neighbors becomes a live cell, and (3) all other cells become dead cells. Using these three simple rules, chaotic and complex behavior emerges.
  <br><br>
  <span class = "setting">Cell Rules</span> can be turned on and off to change how many neighbors each cell needs to be born or to survive, which will drastically change how the simulation runs.
  <br><br>
  Click the <span class = "setting">Reset</span> button to revert the grid to the last edited state.
  <br><br>
  <b><i>Click and drag on the canvas to turn cells on or off (it is recommended to pause the simulation before drawing).</i></b>
  <br><br>
  <table>
    <tr>
      <td>
        <table id = "hotkey-table-general">
          <tr>
            <td style = "min-width: 0; padding: 0" colspan = "3">
              <span class = "hotkey-txt"><u>General Hotkeys</u></span>
            </td>
          </tr>
        </table>
      </td>
      <td>
        <table id = "hotkey-table-structures">
          <tr>
            <td style = "min-width: 0; padding: 0" colspan = "3">
              <span class = "hotkey-txt"><u>Structure Hotkeys</u></span>
            </td>
          </tr>
        </table>
      </td>
    </tr>
  </table>
</div>
<table>
  <tr valign = "top">
    <td colspan = "3">
      <div style = "display: flex">
        <div class = "padded-div"><button onclick = "startStop()" id = "start-stop-btn" class = "running-btn" title = "Play/Pause (P)">Running...</button></div>
        <div class = "padded-div"><button onclick = "if (!canvasRunning) frame()" id = "step-btn" class = "step-btn-inactive" title = "Step One Tick (S)" DISABLED>Step</button></div>
        <div class = "padded-div"><button onclick = "resetGrid()" id = "reset-btn" class = "reset-btn-active" title = "Reset Grid (R)">Reset</button></div>
        <div class = "padded-div"><button onclick = "clearGrid()" title = "Clear Grid (C)">Clear</button></div>
        <div class = "padded-div"><button onclick = "randomizeGrid()" title = "Randomize Grid (V)">Randomize</button></div>
        <div class = "padded-div">
          <div><b><i>Randomization Density:</i></b> <span id = "fill-chance-txt">15</span>%</div>
          <input type = "range" min = "5" max = "95" value = "15" step = "5" id = "fill-chance-range" oninput = "updateSettings(false, false)">
        </div>
      </div>
      <div style = "display: flex">
        <div class = "padded-div"><button id = "exit-placing-btn" class = "smaller-btn" onclick = "initStruct(-1)" style = "visibility: hidden" title = "Exit Placing (Esc)">Exit Structure Placing</button></div>
        <div class = "padded-div">
          <div id = "structure-name-txt" style = "margin-top: 8px"></div>
        </div>
      </div>
    </td>
  </tr>
  <tr valign = "top">
    <td>
      <div id = "canvas-div">
        <canvas id = "canvas">If you're seeing this text, your browser does not support the canvas element.</canvas>
        <canvas id = "top-canvas"></canvas>
      </div>
      <table style = "width: 100%">
        <tr>
          <td class = "census-td">
            <div><b><u>Generations:</u></b></div>
            <div id = "generations-txt" class = "census-txt"></div>
          </td>
          <td class = "census-td">
            <div><b><u>Population:</u></b></div>
            <div id = "population-txt" class = "census-txt"></div>
          </td>
          <td class = "census-td">
            <div><b><u>Density:</u></b></div>
            <div id = "density-txt" class = "census-txt"></div>
          </td>
        </tr>
      </table>
      <br>
      <button class = "download-canvas-btn" onclick = "downloadCanvas()">Download Screenshot</button>
    </td>
    <td style = "padding-right: 10px; border-right: 4px solid #01017a">
      <br>
      <div><b><u>Update Rate:</u></b> <span id = "fps-txt">20 FPS<br><br></span></div>
      <input type = "range" min = "0" max = "10" step = "1" value = "0" id = "fps-range" oninput = "updateSettings(false, false)">
      <br><br>
      <div class = "colored-div">
        <div class = "small-title">&mdash; &mdash; Cell Rules &mdash; &mdash;</div>
        <div id = "curr-rule-txt">(Selected: Game of Life)</div>
        <div style = "text-align: center"><b><span class = "slightly-larger-txt">BORN</span> with __ neighbors:</b></div>
        <div style = "display: flex; align-items: center; justify-content: center" id = "born-with-div"></div>
        <br>
        <div style = "text-align: center"><b><span class = "slightly-larger-txt">SURVIVE</span> with __ neighbors:</b></div>
        <div style = "display: flex; align-items: center; justify-content: center" id = "survive-with-div"></div>
        <div style = "text-align: center"><button onclick = "randomizeRule()" class = "normal-btn">Random Rule</button></div>
      </div>
      <hr>
      <div><b><u>Grid Size:</u></b> <span id = "grid-size-txt">75&times;75</span></div>
      <input type = "range" min = "0" max = "10" value = "0" step = "1" id = "grid-size-range" oninput = "updateSettings(true, false)">
      <br><br><br>
      <label for = "show-grid-lines-checkbox"><b><u>Grid Lines:</u></b> <input type = "checkbox" id = "show-grid-lines-checkbox" oninput = "updateSettings(false, false); drawGrid()" CHECKED></label>
      <br><br><br>
      <label for = "wrap-edges-checkbox"><b><u>Wrap Grid Around Edges:</u></b> <input type = "checkbox" id = "wrap-edges-checkbox" oninput = "updateSettings(false, false)" CHECKED></label>
    </td>
    <td>
      <button onclick = "showSection('a', NUM_SECTIONS_A, 1)" class = "section-btn-inactive" id = "show-section-btn-a-1">Rules</button>
      <button onclick = "showSection('a', NUM_SECTIONS_A, 2)" class = "section-btn-inactive" id = "show-section-btn-a-2">Structures</button>
      <button onclick = "showSection('a', NUM_SECTIONS_A, 3)" class = "section-btn-inactive" id = "show-section-btn-a-3">Colors</button>
      <hr>
      <div id = "section-a-1" style = "display: none">
        <div class = "small-title" style = "text-align: left"><b>Load Rule Presets:</b></div>
        <div class = "little-font">Click to change the ruleset for Cell Rules, changing how the simulation runs.</div>
        <div id = "chaotic-presets-div" class = "rule-preset-div">
          <div class = "rule-preset-title">- - Chaotic - -</div>
        </div>
        <div id = "stable-presets-div" class = "rule-preset-div">
          <div class = "rule-preset-title">- - Stable - -</div>
        </div>
        <div id = "spreading-presets-div" class = "rule-preset-div">
          <div class = "rule-preset-title">- - Spreading - -</div>
        </div>
        <div id = "exploding-presets-div" class = "rule-preset-div">
          <div class = "rule-preset-title">- - Exploding - -</div>
        </div>
      </div>
      <div id = "section-a-2" style = "display: none">
		<div class = "rule-preset-title">Structure Preview:</div>
		<div id = "struct-desc-txt-wrapper">(Selected: <span id = "struct-desc-txt"></span>)</div>
		<canvas id = "struct-canvas" onclick = "togglePlacingStruct()" title = 'Structure Preview (Click or press "Esc" to toggle structure placing)'>If you're seeing this text, your browser does not support the canvas element.</canvas>
		<br>
        <button class = "smaller-btn" onclick = "simulateKeyPress(',')" title = "Mirror Struct Horizontally (Comma)">Mirror Struct <b><i>Horizontally</i></b></button>
        <button class = "smaller-btn" onclick = "simulateKeyPress('.')" title = "Mirror Struct Vertically (Period)">Mirror Struct <b><i>Vertically</i></b></button>
        <br>
        <button class = "smaller-btn" onclick = "simulateKeyPress('l')" title = "Rotate Struct Left (L)">Rotate Struct <b><i>Left</i></b></button>
        <button class = "smaller-btn" onclick = "simulateKeyPress(';')" title = "Rotate Struct Right (Semicolon)">Rotate Struct <b><i>Right</i></b></button>
		<br><br>
		<div class = "small-title" style = "text-align: left"><b>Load Structure Presets:</b></div>
        <div class = "little-font">Click on a structure button to select it. When it's selected, click anywhere on the grid to place that structure there. Click the "Exit Structure Placing" button above the grid to leave this mode.</div>
        <br>
        <button onclick = "showSection('b', NUM_SECTIONS_B, 2)" class = "section-btn-inactive" id = "show-section-btn-b-2">Shapes</button>
		<button onclick = "showSection('b', NUM_SECTIONS_B, 1)" class = "section-btn-inactive" id = "show-section-btn-b-1">Game of Life</button>
		<button onclick = "showSection('b', NUM_SECTIONS_B, 3)" class = "section-btn-inactive" id = "show-section-btn-b-3">Move</button>
		<button onclick = "showSection('b', NUM_SECTIONS_B, 4)" class = "section-btn-inactive" id = "show-section-btn-b-4">Day and Night</button>
		<button onclick = "showSection('b', NUM_SECTIONS_B, 5)" class = "section-btn-inactive" id = "show-section-btn-b-5">2x2</button>
		<button onclick = "showSection('b', NUM_SECTIONS_B, 6)" class = "section-btn-inactive" id = "show-section-btn-b-6">Flock</button>
		<button onclick = "showSection('b', NUM_SECTIONS_B, 7)" class = "section-btn-inactive" id = "show-section-btn-b-7">Diamoeba</button>
		<button onclick = "showSection('b', NUM_SECTIONS_B, 8)" class = "section-btn-inactive" id = "show-section-btn-b-8">34 Life</button>
        <br>
        <div id = "section-b-1" style = "display: none">
          <div class = "little-font" style = "margin-top: 3px"><b>These structures only work when running the "Game of Life" rule preset.</b> <button class = "preset-btn" onclick = "loadRuleFromName('Game of Life')">Select "Game of Life" Rule</button></div>
          <div id = "spaceships-structures-div" class = "rule-preset-div">
            <div class = "rule-preset-title">- - Spaceships - -</div>
          </div>
          <div id = "oscillators-structures-div" class = "rule-preset-div">
            <div class = "rule-preset-title">- - Oscillators - -</div>
          </div>
          <div id = "puffers-structures-div" class = "rule-preset-div">
            <div class = "rule-preset-title">- - Puffers/Rakes - -</div>
          </div>
          <div id = "spacefillers-structures-div" class = "rule-preset-div">
            <div class = "rule-preset-title">- - Spacefillers - -</div>
          </div>
          <div id = "guns-structures-div" class = "rule-preset-div">
            <div class = "rule-preset-title">- - Guns - -</div>
          </div>
          <div id = "glider-synthesis-structures-div" class = "rule-preset-div">
            <div class = "rule-preset-title">- - Glider Synthesis - -</div>
          </div>
		  <br>
		  <div class = "little-font" style = "margin-top: 3px">Credit to <a href = "https://conwaylife.com/ref/lexicon/lex.htm" target = "_blank">Life Lexicon</a> for cataloguing these designs.</div>
        </div>
		
        <div id = "section-b-2" style = "display: none">
			<div class = "little-font" style = "margin-top: 3px"><b>These structures aren't intended for any specific rule set, and merely serve as shortcuts to drawing specific designs.</b></div>
          <div id = "shapes-structures-div" class = "rule-preset-div">
            <div class = "rule-preset-title">- - Select Shape - -</div>
          </div>
          <div class = "rule-preset-div">
            <div class = "rule-preset-title">- - Shape Settings - -</div>
            <table>
              <tr>
                <td style = "min-width: 0">
                  <div id = "shape-width-div" style = "display: block" class = "shape-property-div">
                    <div><b><u>Width:</u></b> <span id = "shape-struct-width-txt">9</span></div>
                    <input type = "range" min = "1" max = "50" step = "1" value = "9" id = "shape-struct-width-range" oninput = "updateSettings(false, true)">
                  </div>
                  <div id = "shape-height-div" style = "display: block" class = "shape-property-div">
                    <div><b><u>Height:</u></b> <span id = "shape-struct-height-txt">9</span></div>
                    <input type = "range" min = "1" max = "50" step = "1" value = "9" id = "shape-struct-height-range" oninput = "updateSettings(false, true)">
                  </div>
                  <div id = "shape-length-div" style = "display: none" class = "shape-property-div">
                    <div><b><u>Length:</u></b> <span id = "shape-struct-length-txt">9</span></div>
                    <input type = "range" min = "1" max = "50" step = "1" value = "9" id = "shape-struct-length-range" oninput = "updateSettings(false, true)">
                  </div>
                  <div id = "shape-thickness-div" style = "display: none" class = "shape-property-div">
                    <div><b><u>Thickness:</u></b> <span id = "shape-struct-thickness-txt">2</span></div>
                    <input type = "range" min = "1" max = "10" step = "1" value = "2" id = "shape-struct-thickness-range" oninput = "updateSettings(false, true)">
                  </div>
				  <div id = "shape-random-density-div" style = "display: none" class = "shape-property-div">
                    <div><b><u>Randomization Density:</u></b> <span id = "shape-struct-random-density-txt">50</span>%</div>
                    <input type = "range" min = "5" max = "95" step = "5" value = "50" id = "shape-struct-random-density-range" oninput = "updateSettings(false, true)">
                  </div>
                </td>
                <td style = "min-width: 0">
				  <div id = "shape-fill-div" style = "display: block">
                    <div><b><u>Fill Type:</u></b></div>
                    <input type = "radio" name = "shape-struct-fill-radio" id = "shape-struct-fill-radio-0" oninput = "updateSettings(false, true)" CHECKED>
                    <label for = "shape-struct-fill-radio-0">Outline</label>
                    <br>
                    <input type = "radio" name = "shape-struct-fill-radio" id = "shape-struct-fill-radio-1" oninput = "updateSettings(false, true)">
                    <label for = "shape-struct-fill-radio-1">Solid</label>
					<br>
                    <input type = "radio" name = "shape-struct-fill-radio" id = "shape-struct-fill-radio-2" oninput = "updateSettings(false, true)">
                    <label for = "shape-struct-fill-radio-2">Striped</label>
				  </div>
				  <div id = "shape-symmetry-div" style = "display: none">
                    <div><b><u>Randomization Symmetry:</u></b></div>
                    <input type = "radio" name = "shape-struct-symmetry-radio" id = "shape-struct-symmetry-radio-0" oninput = "updateSettings(false, true)">
                    <label for = "shape-struct-symmetry-radio-0">Asymmetric</label>
                    <br>
                    <input type = "radio" name = "shape-struct-symmetry-radio" id = "shape-struct-symmetry-radio-1" oninput = "updateSettings(false, true)" CHECKED>
                    <label for = "shape-struct-symmetry-radio-1">1-Way Symmetric</label>
                    <br>
					<input type = "radio" name = "shape-struct-symmetry-radio" id = "shape-struct-symmetry-radio-2" oninput = "updateSettings(false, true)">
                    <label for = "shape-struct-symmetry-radio-2">2-Way Symmetric</label>
				  </div>
                </td>
              </tr>
            </table>
          </div>
        </div>
		
		<div id = "section-b-3" style = "display: none">
          <div class = "little-font" style = "margin-top: 3px"><b>These structures only work when running the "Move" rule preset.</b> <button class = "preset-btn" onclick = "loadRuleFromName('Move')">Select "Move"</button></div>
          <div id = "move-structures-div" class = "rule-preset-div"></div>
		  <br>
		  <div class = "little-font" style = "margin-top: 3px">Credit to <a href = "https://conwaylife.com/wiki/Main_Page" target = "_blank">Life Wiki</a> users for cataloguing these designs.</div>
		</div>
		
		<div id = "section-b-4" style = "display: none">
          <div class = "little-font" style = "margin-top: 3px"><b>These structures only work when running the "Day and Night" rule preset.</b> <button class = "preset-btn" onclick = "loadRuleFromName('Day and Night')">Select "Day and Night"</button></div>
          <div id = "day-and-night-structures-div" class = "rule-preset-div"></div>
		  <br>
		  <div class = "little-font" style = "margin-top: 3px">Credit to <a href = "https://conwaylife.com/wiki/Main_Page" target = "_blank">Life Wiki</a> users for cataloguing these designs.</div>
		</div>
		
		<div id = "section-b-5" style = "display: none">
          <div class = "little-font" style = "margin-top: 3px"><b>These structures only work when running the "2x2" rule preset.</b> <button class = "preset-btn" onclick = "loadRuleFromName('2x2')">Select "2x2"</button></div>
          <div id = "2x2-structures-div" class = "rule-preset-div"></div>
		  <br>
		  <div class = "little-font" style = "margin-top: 3px">Credit to Nathaniel Johnston and <a href = "https://conwaylife.com/wiki/Main_Page" target = "_blank">Life Wiki</a> users for cataloguing these designs.</div>
		</div>
		
		<div id = "section-b-6" style = "display: none">
          <div class = "little-font" style = "margin-top: 3px"><b>These structures only work when running the "Flock" rule preset.</b> <button class = "preset-btn" onclick = "loadRuleFromName('Flock')">Select "Flock"</button></div>
          <div id = "flock-structures-div" class = "rule-preset-div"></div>
		  <br>
		  <div class = "little-font" style = "margin-top: 3px">Credit to <a href = "https://conwaylife.com/wiki/Main_Page" target = "_blank">Life Wiki</a> users for cataloguing these designs.</div>
		</div>
		
		<div id = "section-b-7" style = "display: none">
          <div class = "little-font" style = "margin-top: 3px"><b>These structures only work when running the "Diamoeba" rule preset.</b> <button class = "preset-btn" onclick = "loadRuleFromName('Diamoeba')">Select "Diamoeba"</button></div>
          <div id = "diamoeba-structures-div" class = "rule-preset-div"></div>
		  <br>
		  <div class = "little-font" style = "margin-top: 3px">Credit to <a href = "https://conwaylife.com/wiki/Main_Page" target = "_blank">Life Wiki</a> users for cataloguing these designs.</div>
		</div>
		
		<div id = "section-b-8" style = "display: none">
          <div class = "little-font" style = "margin-top: 3px"><b>These structures only work when running the "34 Life" rule preset.</b> <button class = "preset-btn" onclick = "loadRuleFromName('34 Life')">Select "34 Life"</button></div>
          <div id = "34-life-structures-div" class = "rule-preset-div"></div>
		  <br>
		  <div class = "little-font" style = "margin-top: 3px">Credit to <a href = "https://conwaylife.com/wiki/Main_Page" target = "_blank">Life Wiki</a> users for cataloguing these designs.</div>
		</div>
      </div>
      <div id = "section-a-3" style = "display: none">
        <div class = "small-title" style = "text-align: left"><b>Change Simulation Colors:</b></div>
		<br><br>
		<label for = "cell-trailing-checkbox"><b><u>Cell Trailing:</u></b> <input type = "checkbox" id = "cell-trailing-checkbox" oninput = "updateSettings(false, false); drawGrid()"></label>
		<br><br><br>
		<div><b><u>Trailing Rate:</u></b> <span id = "clear-rate-txt">70</span>%</div>
		<input type = "range" min = "20" max = "90" value = "70" step = "10" id = "clear-rate-range" oninput = "updateSettings(false, false)">
	  </div>
    </td>
  </tr>
</table>
<br>
<script src = "scripts/main.js"></script>
<script>
  let canvas = document.getElementById("canvas");
  const ctx = canvas.getContext("2d");
  
  let topCanvas = document.getElementById("top-canvas");
  const tctx = topCanvas.getContext("2d");
  
  let structCanvas = document.getElementById("struct-canvas");
  const sctx = structCanvas.getContext("2d");
  let structCanvasSize = 500;
  structCanvas.width = structCanvas.height = structCanvasSize;
  
  let canvasSize = 1000;
  canvas.width = canvas.height = topCanvas.width = topCanvas.height = canvasSize;
  let canvasRunning = true;
  let FPS = 20;
  
  const NUM_SECTIONS_A = 3;
  const NUM_SECTIONS_B = 8;
  
  // HTML element reference declarations
  let fpsRange = document.getElementById("fps-range");
  let fpsTxt = document.getElementById("fps-txt");
  let startStopBtn = document.getElementById("start-stop-btn");
  let bornWithDiv = document.getElementById("born-with-div");
  let surviveWithDiv = document.getElementById("survive-with-div");
  let stepBtn = document.getElementById("step-btn");
  let generationsTxt = document.getElementById("generations-txt");
  let populationTxt = document.getElementById("population-txt");
  let densityTxt = document.getElementById("density-txt");
  let gridSizeRange = document.getElementById("grid-size-range");
  let gridSizeTxt = document.getElementById("grid-size-txt");
  let showGridLinesCheckbox = document.getElementById("show-grid-lines-checkbox");
  let fillChanceRange = document.getElementById("fill-chance-range");
  let fillChanceTxt = document.getElementById("fill-chance-txt");
  let wrapEdgesCheckbox = document.getElementById("wrap-edges-checkbox");
  let resetBtn = document.getElementById("reset-btn");
  let exitPlacingBtn = document.getElementById("exit-placing-btn");
  let structureNameTxt = document.getElementById("structure-name-txt");
  let shapeStructWidthTxt = document.getElementById("shape-struct-width-txt");
  let shapeStructWidthRange = document.getElementById("shape-struct-width-range");
  let shapeStructHeightTxt = document.getElementById("shape-struct-height-txt");
  let shapeStructHeightRange = document.getElementById("shape-struct-height-range");
  let shapeStructLengthTxt = document.getElementById("shape-struct-length-txt");
  let shapeStructLengthRange = document.getElementById("shape-struct-length-range");
  let shapeStructThicknessTxt = document.getElementById("shape-struct-thickness-txt");
  let shapeStructThicknessRange = document.getElementById("shape-struct-thickness-range");
  let shapeStructRandomDensityTxt = document.getElementById("shape-struct-random-density-txt");
  let shapeStructRandomDensityRange = document.getElementById("shape-struct-random-density-range");
  let shapeWidthDiv = document.getElementById("shape-width-div");
  let shapeHeightDiv = document.getElementById("shape-height-div");
  let shapeLengthDiv = document.getElementById("shape-length-div");
  let shapeThicknessDiv = document.getElementById("shape-thickness-div");
  let shapeRandomDensityDiv = document.getElementById("shape-random-density-div");
  let shapeStructFillRadio0 = document.getElementById("shape-struct-fill-radio-0");
  let shapeStructFillRadio1 = document.getElementById("shape-struct-fill-radio-1");
  let shapeStructFillRadio2 = document.getElementById("shape-struct-fill-radio-2");
  let shapeSymmetryDiv = document.getElementById("shape-symmetry-div");
  let shapeStructSymmetryRadio0 = document.getElementById("shape-struct-symmetry-radio-0");
  let shapeStructSymmetryRadio1 = document.getElementById("shape-struct-symmetry-radio-1");
  let shapeStructSymmetryRadio2 = document.getElementById("shape-struct-symmetry-radio-2");
  let shapeFillDiv = document.getElementById("shape-fill-div");
  let clearRateTxt = document.getElementById("clear-rate-txt");
  let clearRateRange = document.getElementById("clear-rate-range");
  let cellTrailingCheckbox = document.getElementById("cell-trailing-checkbox");
  let structDescTxt = document.getElementById("struct-desc-txt");
  let currRuleTxt = document.getElementById("curr-rule-txt");
  
  let placingStruct = false; // Whether a structure is currently selected or not
  let structWidth = 0; // Size of the selected structure
  let structHeight = 0;
  let structCode = [""]; // Encoded state of the structure, as an array of strings
  let structIndex = -1; // Index in the structures array
  let lastStructIndex = 0; // Last-selected struct
  let willPlaceStruct = false; // Once-used variable for placing structs while canvas is running
  let structFitsOnGrid = true; // Whether or not the current struct is small enough to be placed on the grid
  
  // Struct State is a very complicated variable, even though it only holds an integer from 0-7 inclusive
  // It represents the 8 possible orientations of a square on a grid (all 4 quarter-turn rotations, along with each one's mirror)
  // This is what allows me to go from any orientation to any other, without using complicated geometry or anything
  // It just maps between different states using the various "map" arrays
  let structState = 0;
  
  let flipHorizontallyMap = [6, 5, 4, 7, 2, 1, 0, 3];
  let flipVerticallyMap = [4, 7, 6, 5, 0, 3, 2, 1];
  let rotateLeftMap = [3, 0, 1, 2, 7, 4, 5, 6];
  let rotateRightMap = [1, 2, 3, 0, 5, 6, 7, 4];
  
  // Settings specific to the structures in the "Shapes" subtab
  // Not all of these settings are used for every shape -- selecting a different shape will change which setting sliders are visible vs invisible
  // For example, "Rectangle" has Width/Height/Thickness, while "X" has Length/Thickness
  let shapeStructWidth = 9;
  let shapeStructHeight = 9;
  let shapeStructFill = 0; // 0: Outline  |  1: Solid  |  2: Striped
  let shapeStructLength = 9;
  let shapeStructThickness = 2;
  let shapeStructRandomDensity = 0.5; // Randomization density for the "Static" shape
  let shapeStructSymmetry = 1; // Symmetry for the "Static" shape  |  0: Asymmetric  |  1: 1-Way Symmetry  |  2: 2-Way Symmetry
  
  // Arrays to define custom ranges for HTML sliders
  let fpsRangeArray = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 20, 25, 30, 40, 50, -1, -2, -3, -4, -5, -11];
  fpsRange.max = fpsRangeArray.length - 1;
  fpsRange.value = fpsRangeArray.indexOf(20);
  
  let gridSizeRangeArray = [5, 10, 15, 20, 30, 40, 50, 75, 100, 150, 200, 250];
  gridSizeRange.max = gridSizeRangeArray.length - 1;
  gridSizeRange.value = gridSizeRangeArray.indexOf(75);
  
  let Mouse = {
    x: 0, // Actual x and y of the mouse, relative to the canvas
    y: 0,
    down: false,
    mode: 1, // Which state the mouse will convert cells to when dragging
    gridX: 0, // Which cell on the grid the mouse is currently hovering over
    gridY: 0,
    movedSinceLastClick: false
  };
  
  let Keys = { // Which hotkeys are currently down
    rDown: false,
    escDown: false,
    pDown: false,
    cDown: false,
    vDown: false,
    commaDown: false,
    periodDown: false,
    lDown: false,
    semicolonDown: false
  };
  
  let grid = [];
  let gridSize = 75;
  let tileSize = 0;
  let wrapEdges = true;
  
  let lastGrid = []; // Last user-edited grid, which is what resetGrid() reloads to
  
  let born = []; // Each is an array of true or false, showing whether that checkbox is checked
  let survive = [];
  
  let generations = 0;
  
  let bgColor = "white";
  let cellColor = "black";
  let gridLineColor = "lightgray";
  
  let gridLineWidth = 0.15;
  
  let showGridLines = true;
  
  let fillChance = 0.15; // Randomization density
  
  let clearRate = 1; // Rate at which the grid clears over time - lower values increase trailing
  
  function updateSettings(changingGridSize, changingStructSettings) {
    // Update actual JavaScript variables to match user inputted HTML
    // changingGridSize parameter is always false unless called by gridSizeRange
    
    let fpsRangeValue = fpsRangeArray[Number(fpsRange.value)];
    FPS = fpsRangeValue;
    if (FPS >= 0) fpsTxt.innerHTML = FPS + " FPS<br><br>";
    else {
      if (FPS === -1) fpsTxt.innerHTML = "<i>Unlimited</i><br><br>";
      else fpsTxt.innerHTML = `<i>Unlimited</i><br><i>(${Math.abs(FPS)} steps per frame)</i>`;
    }
    
    let lastGridSize = gridSize;
    gridSize = gridSizeRangeArray[Number(gridSizeRange.value)];
    gridSizeTxt.innerHTML = gridSize + "&times;" + gridSize;
    
    showGridLines = showGridLinesCheckbox.checked;
    
    fillChanceTxt.innerHTML = Number(fillChanceRange.value);
    fillChance = Number(fillChanceRange.value) / 100;
    
    wrapEdges = wrapEdgesCheckbox.checked;
    if (wrapEdges) canvas.style.outline = "2px solid rgb(200, 200, 200)";
    else canvas.style.outline = "2px solid black";
    
    shapeStructWidth = shapeStructWidthTxt.innerHTML = Number(shapeStructWidthRange.value);
    shapeStructHeight = shapeStructHeightTxt.innerHTML = Number(shapeStructHeightRange.value);
    shapeStructLength = shapeStructLengthTxt.innerHTML = Number(shapeStructLengthRange.value);
    shapeStructThickness = shapeStructThicknessTxt.innerHTML = Number(shapeStructThicknessRange.value);
	shapeStructRandomDensityTxt.innerHTML = shapeStructRandomDensityRange.value;
	shapeStructRandomDensity = Number(shapeStructRandomDensityRange.value) / 100;
    
    if (shapeStructFillRadio0.checked) shapeStructFill = 0;
    else if (shapeStructFillRadio1.checked) shapeStructFill = 1;
	else if (shapeStructFillRadio2.checked) shapeStructFill = 2;
	
	if (shapeStructSymmetryRadio0.checked) shapeStructSymmetry = 0;
	else if (shapeStructSymmetryRadio1.checked) shapeStructSymmetry = 1;
	else if (shapeStructSymmetryRadio2.checked) shapeStructSymmetry = 2;
	
	clearRateTxt.innerHTML = clearRateRange.value;
	clearRate = 1 - (Number(clearRateRange.value) / 100);
	if (clearRate > 0.95) clearRate = 1;
	
	if (!cellTrailingCheckbox.checked) clearRate = 1;
    
	checkIfStructFits();
	
    if (changingGridSize) updateGridSize(lastGridSize);
	
	if (changingStructSettings) { // If stuct settings are being changed, update struct information
	  let n = structIndex === -1 ? lastStructIndex : structIndex;
	  
	  let preset = structures[n];
      
      if (preset.category === "Shapes") {
        // If drawing a shape, go through and enable/disable various setting sliders based on which shape is selected
		
		initShapeStruct(n);
      }
	  
	  let i = structIndex;
      initStruct(-1);
      initStruct(i);
	  
	  structCanvasPreview();
	}
  }
  
  function checkIfStructFits() {
    // Checks if the currently selected structure actually fits on the current grid
	
	let n = structIndex === -1 ? lastStructIndex : structIndex;
	
	if (structWidth > gridSize || structHeight > gridSize) { // If it doesn't fit, display a red error message
	  structFitsOnGrid = false;
	  structureNameTxt.innerHTML = "<span style = 'color:red'><b><i>ERROR: \"" + getStructName(n) + "\" does not fit on the grid.</i></b></span>";
	}
	else { // Otherwise, display struct name like usual
	  structFitsOnGrid = true;
	  structureNameTxt.innerHTML = "<b>(Placing: " + getStructName(n) + ")</b>";
	}
  }
  
  function updateGridSize(lastGridSize) {
    // Saves the current grid state, and then places that in the center of the grid after resizing
    // This means resizing the grid will still save your current cells
    
    let currGrid = [];
    for (let x = 0; x < lastGridSize; x++) {
      let col = [];
      for (let y = 0; y < lastGridSize; y++) {
        col.push(grid[x][y]);
      }
      currGrid.push(col);
    }
    
    clearGrid();
    
    for (let x = 0; x < lastGridSize; x++) {
      for (let y = 0; y < lastGridSize; y++) {
        let _x = Math.floor(gridSize / 2) - Math.floor(lastGridSize / 2) + x;
        let _y = Math.floor(gridSize / 2) - Math.floor(lastGridSize / 2) + y;
        let xOn = _x >= 0 && _x < gridSize; // x-value within grid size
        let yOn = _y >= 0 && _y < gridSize; // y-value within grid size
        if (xOn && yOn) grid[_x][_y] = currGrid[x][y];
      }
    }
	
	checkIfStructFits(); // Changing the grid size has the potential to change whether or not the current struct fits, so re-check that
    
    drawGrid();
    
    // This counts as user input, so save the grid state
    setLastGrid();
  }
  
  window.addEventListener("keydown", e => {
    if ((e.keyCode === 27 || e.code === "Escape") && !Keys.escDown) { // If esc is pressed (not held):
      Keys.escDown = true;
      togglePlacingStruct();
    }
    
    if ((e.keyCode === 82 || e.code === "KeyR") && !Keys.rDown) { // If R is pressed (not held):
      Keys.rDown = true;
      resetGrid();
    }
    
    if ((e.keyCode === 80 || e.code === "KeyP") && !Keys.pDown) { // If P is pressed (not held):
      Keys.pDown = true;
      startStop();
    }
    
    if ((e.keyCode === 67 || e.code === "KeyC") && !Keys.cDown) { // If C is pressed (not held):
      Keys.cDown = true;
      clearGrid();
    }
    
    if ((e.keyCode === 86 || e.code === "KeyV") && !Keys.vDown) { // If V is pressed (not held):
      Keys.vDown = true;
      randomizeGrid();
    }
    
    if ((e.keyCode === 83 || e.code === "KeyS") && !canvasRunning) frame(); // If S is pressed (or held):
    
    let changedStruct = false; // Whether or not a structure-related hotkey has been pressed
    
    if ((e.keyCode === 188 || e.code === "Comma") && !Keys.commaDown) { // If comma is pressed (not held):
      structState = flipHorizontallyMap[structState]; // Change structState to reflect the horizontal mirroring
      
      Keys.commaDown = true;
      changedStruct = true;
    }
    if ((e.keyCode === 190 || e.code === "Period") && !Keys.periodDown) { // If period is pressed (not held):
      structState = flipVerticallyMap[structState]; // Change structState to reflect the vertical mirroring
      
      Keys.periodDown = true;
      changedStruct = true;
    }
    
    if ((e.keyCode === 76 || e.code === "KeyL") && !Keys.lDown) { // If L is pressed (not held):
      structState = rotateLeftMap[structState]; // Change structState to reflect the left rotation
      
      Keys.lDown = true;
      changedStruct = true;
    }
    if ((e.keyCode === 186 || e.code === "Semicolon") && !Keys.semicolonDown) { // If semicolon is pressed (not held):
      structState = rotateRightMap[structState]; // Change structState to reflect the right rotation
      
      Keys.semicolonDown = true;
      changedStruct = true;
    }
    
    if (changedStruct && placingStruct) { // If struct hotkeys were pressed, and a structure is being placed:
      updateStruct();
      
      drawGrid();
      
      Mouse.movedSinceLastClick = true;
    }
	if (changedStruct) structCanvasPreview();
  });
  function simulateKeyPress(key) {
    // Replicates the behavior that pressing a certain hotkey does
    // Since I never need to use it for most hotkeys, it only works for the structure-related hotkeys
    
    if (key === ",") {
      structState = flipHorizontallyMap[structState]; // Change structState to reflect the horizontal mirroring
    }
    else if (key === ".") {
      structState = flipVerticallyMap[structState]; // Change structState to reflect the vertical mirroring
    }
    else if (key === "l") {
      structState = rotateLeftMap[structState]; // Change structState to reflect the left rotation
    }
    else if (key === ";") {
      structState = rotateRightMap[structState]; // Change structState to reflect the right rotation
    }
    
    if (placingStruct) {
      updateStruct();
      
      drawGrid();
      
      Mouse.movedSinceLastClick = true;
    }
	
	structCanvasPreview();
  }
  window.addEventListener("keyup", e => {
    if (e.keyCode === 27 || e.code === "Escape") Keys.escDown = false;
    
    if (e.keyCode === 82 || e.code === "KeyR") Keys.rDown = false;
    
    if (e.keyCode === 80 || e.code === "KeyP") Keys.pDown = false;
    
    if (e.keyCode === 67 || e.code === "KeyC") Keys.cDown = false;
    
    if (e.keyCode === 86 || e.code === "KeyV") Keys.vDown = false;
    
    if (e.keyCode === 188 || e.code === "Comma") Keys.commaDown = false;
    
    if (e.keyCode === 190 || e.code === "Period") Keys.periodDown = false;
    
    if (e.keyCode === 76 || e.code === "KeyL") Keys.lDown = false;
    
    if (e.keyCode === 186 || e.code === "Semicolon") Keys.semicolonDown = false;
  });
  
  function setLastGrid() {
    // Save the current grid as lastGrid
    
    let population = 0;
    
    lastGrid = [];
    for (let x = 0; x < gridSize; x++) {
      let column = [];
      for (let y = 0; y < gridSize; y++) {
        column.push(grid[x][y]);
        if (grid[x][y] === 1) population++;
      }
      lastGrid.push(column);
    }
    
    generations = 0;
    
    // Update census information
    generationsTxt.innerHTML = comma(generations);
    populationTxt.innerHTML = comma(population);
    densityTxt.innerHTML = ((population / (gridSize * gridSize)) * 100).toFixed(1) + "%";
  }
  
  function resetGrid() {
    // Set grid to last user-edited state
	
	ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    grid = [];
    for (let x = 0; x < gridSize; x++) {
      let column = [];
      for (let y = 0; y < gridSize; y++) {
        column.push(lastGrid[x][y]);
      }
      grid.push(column);
    }
    
    generations = 0; // The simulation is resetting, so time elapsed is back to 0
    
    drawGrid();
  }
  
  function comma(num) {
    // Add commas to number
	// 123456 --> 123,456
    
    return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
  }
  
  function isValidStructPlacement(x, y) {
    // Checks if the given position is on the grid
	
	return x >= 0 && x < gridSize && y >= 0 && y < gridSize;
  }
  
  function drawGrid() {
    // Draw the current grid state to the canvas
    
	// Draw background at lower opacity for trailing
	ctx.globalAlpha = clearRate;
    ctx.fillStyle = bgColor;
    ctx.fillRect(0, 0, canvas.width, canvas.height);
	ctx.globalAlpha = 1;
	
    tctx.clearRect(0, 0, canvas.width, canvas.height);
    
    tileSize = canvas.width / gridSize;
    
    let population = 0;
    
    for (let x = 0; x < gridSize; x++) {
      for (let y = 0; y < gridSize; y++) {
        if (grid[x][y] === 1) {
          ctx.fillStyle = cellColor;
          ctx.fillRect(x * tileSize, y * tileSize, tileSize, tileSize);
          population++;
        }
      }
    }
    
    // Draw grid lines above cells (on top-canvas)
    if (showGridLines) {
      tctx.strokeStyle = gridLineColor;
      tctx.lineWidth = Math.max(1, (tileSize * gridLineWidth).toMultipleOf(2)); // Make line width an even number to reduce blurring
      
      // Vertical lines
      for (let x = 0; x <= gridSize; x++) {
        tctx.beginPath();
        tctx.moveTo(x * tileSize, 0);
        tctx.lineTo(x * tileSize, canvas.height);
        tctx.stroke();
      }
      
      // Horizontal lines
      for (let y = 0; y <= gridSize; y++) {
        tctx.beginPath();
        tctx.moveTo(0, y * tileSize);
        tctx.lineTo(canvas.width, y * tileSize);
        tctx.stroke();
      }
    }
	
	// Draw a structure preview if necessary
	if (placingStruct && Mouse.movedSinceLastClick) previewStruct(Mouse.gridX, Mouse.gridY);
    
    // Update census information
    generationsTxt.innerHTML = comma(generations);
    populationTxt.innerHTML = comma(population);
    densityTxt.innerHTML = ((population / (gridSize * gridSize)) * 100).toFixed(1) + "%";
  }
  
  function drawOneCell(gridX, gridY, state, opacity, ctx) {
    // Draw one single cell, and its grid lines
    
    ctx.fillStyle = bgColor;
    ctx.fillRect(gridX * tileSize, gridY * tileSize, tileSize, tileSize);
	
    ctx.fillStyle = state === 1 ? cellColor : bgColor;
    ctx.globalAlpha = state === 1 ? opacity : 1;
    ctx.fillRect(gridX * tileSize, gridY * tileSize, tileSize, tileSize);
    ctx.globalAlpha = 1;
  }
  
  function wrapPos(x, y) {
    // Wrap position around grid edges to be on the actual grid, Pac-Man style
    // (or return original position if its already on the grid)
    
    if (!wrapEdges && (x < 0 || x >= gridSize || y < 0 || y >= gridSize)) return 0; // If not wrapping edges, and the current position is off the canvas, return an empty cell
    
    return grid[((x % gridSize) + gridSize) % gridSize][((y % gridSize) + gridSize) % gridSize]; // Otherwise return cell value
  }
  
  function countNeighbors(x, y) {
    // Sum of 8 neighbors around given cell
    
    let count = 0;
    
    count += wrapPos(x, y - 1); // Top
    count += wrapPos(x + 1, y - 1); // Top right
    count += wrapPos(x + 1, y); // Right
    count += wrapPos(x + 1, y + 1); // Bottom right
    count += wrapPos(x, y + 1); // Bottom
    count += wrapPos(x - 1, y + 1); // Bottom left
    count += wrapPos(x - 1, y); // Left
    count += wrapPos(x - 1, y - 1); // Top left
    
    return count;
  }
  
  function updateGrid() {
    // Iterate through all cells and update their state according to the born/survive ruleset
    
    generations++;
    
    // Set up grid for next iteration
    let nextGrid = [];
    for (let x = 0; x < gridSize; x++) {
      let column = [];
      for (let y = 0; y < gridSize; y++) {
        column.push(grid[x][y]);
      }
      nextGrid.push(column);
    }
    
    // Update each cell and copy its new state to nextGrid
    for (let x = 0; x < gridSize; x++) {
      for (let y = 0; y < gridSize; y++) {
        let neighbors = countNeighbors(x, y);
        
        for (let i = 0; i <= 8; i++) { // Loop through all 9 possible neighbor values
          if (countNeighbors(x, y) === i) {
            if (grid[x][y] === 0 && born[i]) nextGrid[x][y] = 1; // Dead cell is born
            else if (grid[x][y] === 1 && !survive[i]) nextGrid[x][y] = 0; // Live cell dies (all other cells stay the same)
          }
        }
      }
    }
    
    // Copy nextGrid to grid
    for (let x = 0; x < gridSize; x++) {
      for (let y = 0; y < gridSize; y++) {
        grid[x][y] = nextGrid[x][y];
      }
    }
  }
  
  function randomizeGrid() {
    // Fills the canvas randomly with black/white cells, according to fillChance
    
    // Set canvas size to an integer multiple of gridSize, as close to 1000x1000 as possible
    // This removes Moire patterns from tiles being like 53.7 pixels large
    canvas.width = canvas.height = topCanvas.width = topCanvas.height = gridSize * Math.round(canvasSize / gridSize);
    tileSize = canvas.width / gridSize;
    if (tileSize < 10) { // Don't let tile size get too small
      tileSize = 10;
      canvas.width = canvas.height = topCanvas.width = topCanvas.height = gridSize * tileSize;
    }
    
    // Re-initialize grid to fix any potential errors with gridSize not matching the dimensions of the current grid
    grid = [];
    
    for (let x = 0; x < gridSize; x++) {
      let column = [];
      for (let y = 0; y < gridSize; y++) {
        column.push(Math.random() < fillChance ? 1 : 0);
      }
      grid.push(column);
    }
    
    generations = 0;
    
    // This counts as a user input, so it saves the grid state
    setLastGrid();
    
    drawGrid();
  }
  
  function clearGrid() {
    // Sets every cell in the grid to 0
    
    // Set canvas size to an integer multiple of gridSize, as close to 1000x1000 as possible
    // This removes Moire patterns from tiles being like 53.7 pixels large
    canvas.width = canvas.height = topCanvas.width = topCanvas.height = gridSize * Math.round(canvasSize / gridSize);
    tileSize = canvas.width / gridSize;
    if (tileSize < 10) { // Tile size should never go below 10px (it gets too blurry), so if it does, make the canvas larger
      tileSize = 10;
      canvas.width = canvas.height = topCanvas.width = topCanvas.height = gridSize * tileSize;
    }
    
    // Re-initialize grid to fix any potential errors with gridSize not matching the dimensions of the current grid
    grid = [];
    
    for (let x = 0; x < gridSize; x++) {
      let column = [];
      for (let y = 0; y < gridSize; y++) {
        column.push(0);
      }
      grid.push(column);
    }
    
    generations = 0;
    
    // This doesn't count as user input, so it will retain the previously saved grid state (no setLastGrid())
    
    drawGrid();
  }
  
  function updatePresetButtons(b, s) {
    // Given an array of born values and survive values, check if it matches any preset
    // If it does, turn that one active
    
	let matchedCode = false;
	
    let code = numberifyRule(b, s);
    for (let i = 0; i < presets.length; i++) {
      if (presets[i].code === code) {
		presets[i].button.className = "active-preset-btn";
		currRuleTxt.innerHTML = `(Selected: ${presets[i].name})`;
		matchedCode = true;
	  }
      else presets[i].button.className = "preset-btn";
    }
	
	if (!matchedCode) currRuleTxt.innerHTML = `(Selected: Custom Rule)`;
  }
  
  function checksToRules() {
    // Update born and survive arrays to match HTML rule checkboxes
    
    born = [];
    survive = [];
    let b = [];
    let s = [];
    
    for (let i = 0; i <= 8; i++) {
      born.push(document.getElementById("born" + i).checked);
      if (document.getElementById("born" + i).checked) b.push(i);
      survive.push(document.getElementById("survive" + i).checked);
      if (document.getElementById("survive" + i).checked) s.push(i);
    }
    
    // Check if the new rule matches any presets
    updatePresetButtons(b, s);
  }
  
  function rulesToChecks() {
    // Opposite of checksToRules()
    // Updates HTML checkboxes to match actual born and survive arrays
    
    for (let i = 0; i <= 8; i++) {
      document.getElementById("born" + i).checked = born[i];
      document.getElementById("survive" + i).checked = survive[i];
    }
  }
  
  function setRules(b, s) {
    // Update HTML checkboxes AND actual born/survive arrays to match given arrays of born/survive values
	
    born = [];
    survive = [];
    for (let i = 0; i <= 8; i++) {
      born.push(b.includes(i));
      survive.push(s.includes(i));
    }
    
    updatePresetButtons(b, s);
    
    rulesToChecks();
  }
  
  function randomizeRule() {
    // Randomly turn each checkbox on or off
    
    let b = [];
    let s = [];
    
    for (let i = 0; i <= 8; i++) {
      if (Math.random() < 0.5) b.push(i);
      if (Math.random() < 0.5) s.push(i);
    }
    
    setRules(b, s);
  }
  
  function frame() {
    // Do everything
    
    // If FPS is negative, interpret that as how many steps to take per frame
    if (FPS < 0 && canvasRunning) {
      for (let i = 0; i < Math.abs(FPS); i++) updateGrid();
    }
    else updateGrid();
    
    // If the user is drawing, update the cell at the current mouse position
    if (canvasRunning && Mouse.down && !placingStruct) {
      Mouse.gridX = Math.floor(Mouse.x / tileSize);
      Mouse.gridY = Math.floor(Mouse.y / tileSize);
      
      if (Mouse.gridX >= 0 && Mouse.gridX < gridSize && Mouse.gridY >= 0 && Mouse.gridY < gridSize) grid[Mouse.gridX][Mouse.gridY] = Mouse.mode;
    }
    
    // Place struct if mouse was just lifted, then disable the willPlace flag
    if (placingStruct && willPlaceStruct) {
      if (isValidStructPlacement(Mouse.gridX, Mouse.gridY)) placeStruct(Mouse.gridX, Mouse.gridY);
      
      willPlaceStruct = false;
    }
    
    drawGrid();
    
    // If FPS is "unlimited", request an animationFrame (up to user's computer how fast that will be)
    // Otherwise, keep framerate equal to FPS
    if (canvasRunning) {
      if (FPS < 0) requestAnimationFrame(frame);
      else setTimeout(frame, 1000 / FPS);
    }
	else if (placingStruct && Mouse.movedSinceLastClick) previewStruct(Mouse.gridX, Mouse.gridY); // This guarantees that the preview will still be drawn even if the simulation is paused in the middle of a frame
  }
  
  function mousePos(e) {
    // Given a mouseDown or mouseMove event, return the position of the mouse relative to the canvas
    
    let rect = canvas.getBoundingClientRect();
    let ratio = canvas.width / 400;
    
    return {x: (e.clientX - rect.left) * ratio, y: (e.clientY - rect.top) * ratio};
  }
  
  topCanvas.addEventListener("mousedown", e => {
    Mouse.down = true;
    //Mouse.movedSinceLastClick = true;
    
    e.preventDefault();
    
    let pos = mousePos(e);
    Mouse.x = pos.x;
    Mouse.y = pos.y;
    
    Mouse.gridX = Math.floor(Mouse.x / tileSize);
    Mouse.gridY = Math.floor(Mouse.y / tileSize);
    
    // If started drawing on a black cell, draw white cells
    // If started drawing on a white cell, draw black cells
    if (!placingStruct) Mouse.mode = 1 - grid[Mouse.gridX][Mouse.gridY];
    
    if (!canvasRunning && !placingStruct) { // Draw current cell at mouse position
      if (Mouse.gridX >= 0 && Mouse.gridX < gridSize && Mouse.gridY >= 0 && Mouse.gridY < gridSize) grid[Mouse.gridX][Mouse.gridY] = Mouse.mode;
      
      // This is user input, so save current grid state
      setLastGrid();
      
      drawOneCell(Mouse.gridX, Mouse.gridY, grid[Mouse.gridX][Mouse.gridY], 1, ctx);
    }
  });
  window.addEventListener("mousemove", e => {
    if (Mouse.down) e.preventDefault(); // Prevent unwanted text selection that occurs from clicking and dragging on the canvas
    
    let willErase = isValidStructPlacement(Mouse.gridX, Mouse.gridY);
    
    let pos = mousePos(e);
    Mouse.x = pos.x;
    Mouse.y = pos.y;
    
    Mouse.gridX = Math.floor(Mouse.x / tileSize);
    Mouse.gridY = Math.floor(Mouse.y / tileSize);
    
    if (!isValidStructPlacement(Mouse.gridX, Mouse.gridY) && willErase) {
      // If the current struct placement is invalid, but it wasn't invalid before updating, redraw the grid
      // We don't do this every time because it is redundant if the previous placement was invalid, which slows down things a lot
      
      Mouse.movedSinceLastClick = false;
      drawGrid();
      return;
    }
    
    if (!canvasRunning && !placingStruct && Mouse.down) { // Draw current cell at mouse position
      if (Mouse.gridX >= 0 && Mouse.gridX < gridSize && Mouse.gridY >= 0 && Mouse.gridY < gridSize) {
        grid[Mouse.gridX][Mouse.gridY] = Mouse.mode;
      
        // This is user input, so save current grid state
        setLastGrid();
        
        drawOneCell(Mouse.gridX, Mouse.gridY, grid[Mouse.gridX][Mouse.gridY], 1, ctx);
      }
    }
    
    // If a structure is selected, and the simulation is paused, draw a preview every time the mouse moves
    if (placingStruct && !canvasRunning && Mouse.movedSinceLastClick) {
      previewStruct(Mouse.gridX, Mouse.gridY);
    }
    Mouse.movedSinceLastClick = true;
  });
  window.addEventListener("mouseup", e => {
    Mouse.down = false;
    Mouse.movedSinceLastClick = false;
    
    if (!placingStruct) return;
    
    // When mouse is lifted, set willPlace flag to true for next frame() call to place a structure
    
    let pos = mousePos(e);
    Mouse.x = pos.x;
    Mouse.y = pos.y;
    
    Mouse.gridX = Math.floor(Mouse.x / tileSize);
    Mouse.gridY = Math.floor(Mouse.y / tileSize);
    
    if (isValidStructPlacement(Mouse.gridX, Mouse.gridY)) willPlaceStruct = true;
    
    if (!canvasRunning) {
      if (isValidStructPlacement(Mouse.gridX, Mouse.gridY)) placeStruct(Mouse.gridX, Mouse.gridY);
      
      willPlaceStruct = false;
    }
  });
  
  function startStop() {
    // Toggle whether the simulation is currently running
    
    if (canvasRunning) {
      // If running, stop everything
      
      canvasRunning = false;
      
      // Turn start/stop button to red
      startStopBtn.innerHTML = "Paused.";
      startStopBtn.className = "paused-btn";
      
      // Enable step button
      stepBtn.className = "step-btn-active";
      stepBtn.disabled = false;
    }
    else {
      // If not running, start everything
      
      canvasRunning = true;
      
      // Turn start/stop button to green
      startStopBtn.innerHTML = "Running...";
      startStopBtn.className = "running-btn";
      
      // Disable step button
      stepBtn.className = "step-btn-inactive";
      stepBtn.disabled = true;
      
      frame();
    }
  }
  
  function downloadCanvas() {
    // Downloads the current canvas state to the user's device
    
    let link = document.createElement("a");
    link.href = canvas.toDataURL();
    link.download = "life.png";
    link.click();
  }
  
  function numberifyRule(b, s) {
    // Convert an array of born/survive values into a unique integer, to make matching rules with presets easier
    // E.g., Game of Life's code is 6152
    // (Uses binary, each checkbox is the next place value)
    
    let result = 0;
    let mult = 1;
    
    for (let i = 0; i <= 8; i++) {
      if (b.includes(i)) result += mult;
      mult *= 2;
    }
    
    for (let i = 0; i <= 8; i++) {
      if (s.includes(i)) result += mult;
      mult *= 2;
    }
    
    return result;
  }
  
  // Rule presets
  let presets = [
    {
      name: "Game of Life",
      category: "chaotic", // Which preset div to append this preset to
      born: [3],
      survive: [2, 3],
      code: undefined, // Integer code that encodes its ruleset
      button: undefined // Reference to the HTML button that sets this preset
    },
    {
      name: "2x2",
      category: "chaotic",
      born: [3, 6],
      survive: [1, 2, 5],
      code: undefined,
      button: undefined
    },
    {
      name: "Amoeba",
      category: "chaotic",
      born: [3, 5, 7],
      survive: [1, 3, 5, 8],
      code: undefined,
      button: undefined
    },
    {
      name: "Diamoeba",
      category: "chaotic",
      born: [3, 5, 6, 7, 8],
      survive: [5, 6, 7, 8],
      code: undefined,
      button: undefined
    },
    {
      name: "High Life",
      category: "chaotic",
      born: [3, 6],
      survive: [2, 3],
      code: undefined,
      button: undefined
    },
    {
      name: "Inverse Life",
      category: "chaotic",
      born: [0, 1, 2, 3, 4, 7, 8],
      survive: [3, 4, 6, 7, 8],
      code: undefined,
      button: undefined
    },
    {
      name: "Pseudo Life",
      category: "chaotic",
      born: [3, 6, 8],
      survive: [2, 3, 8],
      code: undefined,
      button: undefined
    },
    {
      name: "Assimilation",
      category: "stable",
      born: [3, 4, 5],
      survive: [4, 5, 6, 7],
      code: undefined,
      button: undefined
    },
    {
      name: "Day and Night",
      category: "stable",
      born: [3, 6, 7, 8],
      survive: [3, 4, 6, 7, 8],
      code: undefined,
      button: undefined
    },
    {
      name: "Long Life",
      category: "stable",
      born: [3, 4, 5],
      survive: [5],
      code: undefined,
      button: undefined
    },
    {
      name: "Move",
      category: "stable",
      born: [3, 6, 8],
      survive: [2, 4, 5],
      code: undefined,
      button: undefined
    },
	{
      name: "Flock",
      category: "stable",
      born: [3],
      survive: [1, 2],
      code: undefined,
      button: undefined
    },
    {
      name: "Stains",
      category: "stable",
      born: [3, 6, 7, 8],
      survive: [2, 3, 5, 6, 7, 8],
      code: undefined,
      button: undefined
    },
    {
      name: "Walled Cities",
      category: "stable",
      born: [4, 5, 6, 7, 8],
      survive: [2, 3, 4, 5],
      code: undefined,
      button: undefined
    },
    {
      name: "Anneal",
      category: "stable",
      born: [4, 6, 7, 8],
      survive: [3, 5, 6, 7, 8],
      code: undefined,
      button: undefined
    },
    {
      name: "Museum",
      category: "stable",
      born: [5, 8],
      survive: [3, 4, 6, 7, 8],
      code: undefined,
      button: undefined
    },
    {
      name: "Flakes",
      category: "spreading",
      born: [3],
      survive: [0, 1, 2, 3, 4, 5, 6, 7, 8],
      code: undefined,
      button: undefined
    },
    {
      name: "Coral",
      category: "spreading",
      born: [3],
      survive: [4, 5, 6, 7, 8],
      code: undefined,
      button: undefined
    },
    {
      name: "Maze",
      category: "spreading",
      born: [3],
      survive: [1, 2, 3, 4, 5],
      code: undefined,
      button: undefined
    },
    {
      name: "Stripes",
      category: "spreading",
      born: [3, 4],
      survive: [0, 1, 2, 3, 4, 5, 6],
      code: undefined,
      button: undefined
    },
    {
      name: "Circuitry",
      category: "spreading",
      born: [2, 5, 6, 7],
      survive: [0, 2, 3, 4, 5, 6, 7],
      code: undefined,
      button: undefined
    },
    {
      name: "34 Life",
      category: "exploding",
      born: [3, 4],
      survive: [3, 4],
      code: undefined,
      button: undefined
    },
    {
      name: "Cogaulations",
      category: "exploding",
      born: [3, 7, 8],
      survive: [2, 3, 5, 6, 7, 8],
      code: undefined,
      button: undefined
    },
    {
      name: "Gnarl",
      category: "exploding",
      born: [1],
      survive: [1],
      code: undefined,
      button: undefined
    },
    {
      name: "Replicator",
      category: "exploding",
      born: [1, 3, 5, 7],
      survive: [1, 3, 5, 7],
      code: undefined,
      button: undefined
    },
    {
      name: "Seeds",
      category: "exploding",
      born: [2],
      survive: [],
      code: undefined,
      button: undefined
    },
    {
      name: "Serviettes",
      category: "exploding",
      born: [2, 3, 4],
      survive: [],
      code: undefined,
      button: undefined
    },
    {
      name: "Live Free or Die",
      category: "exploding",
      born: [2],
      survive: [0],
      code: undefined,
      button: undefined
    },
    {
      name: "Iceballs",
      category: "exploding",
      born: [2, 5, 6, 7, 8],
      survive: [5, 6, 7, 8],
      code: undefined,
      button: undefined
    }
    /*{
      name: "NAME",
      category: "THING",
      born: 
      code: undefined,
      button: undefined
    }*/
  ];
  function loadPreset(n) {
    
    let p = presets[n];
    
    setRules(p.born, p.survive);
  }
  
  function loadRuleFromName(name) {
    // Called by 'Select "X"' buttons
	// Loops through all rules to find the one that matches the given name, and loads it
	// This is done without a hardcoded index to the rule itself, so that if I ever add/reorder rules, this function won't break
	
	for (let i = 0; i < presets.length; i++) {
	  if (presets[i].name === name) {
	    loadPreset(i);
		break;
	  }
	}
  }
  
  let hotkeys = [
    {
      key: "P",
      category: "general",
      desc: "Play/Pause Simulation"
    },
    {
      key: "S",
      category: "general",
      desc: "Step Simulation"
    },
    {
      key: "R",
      category: "general",
      desc: "Reset Grid State (to last edited)"
    },
    {
      key: "C",
      category: "general",
      desc: "Clear Grid"
    },
    {
      key: "V",
      category: "general",
      desc: "Randomize Grid"
    },
    {
      key: "Esc",
      category: "structures",
      desc: "Toggle Structure Placing On/Off"
    },
    {
      key: ",",
      category: "structures",
      desc: "Flip Current Structure <b>Horizontally</b>"
    },
    {
      key: ".",
      category: "structures",
      desc: "Flip Current Structure <b>Vertically</b>"
    },
    {
      key: "L",
      category: "structures",
      desc: "Rotate Current Structure to the <b>Left</b>"
    },
    {
      key: ";",
      category: "structures",
      desc: "Rotate Current Structure to the <b>Right</b>"
    },
  ];
  
  let structures = [
    // Game of Life
    {
      name: "Glider",
	  titleText: "Spaceship, c/4", // Hover text for the HTML button
      category: "Game of Life", // Which Structures section it will go under
      subcategory: "spaceships", // Which subsection it will go under on that section
      code: [ // Encoded state of the pattern, X is on and - is off
        "-X-",
        "--X",
        "XXX"
      ],
      button: undefined // Reference to HTML button that activates this structure
    },
    {
      name: "Light Spaceship",
	  titleText: "Spaceship, c/2 (2c/4)",
      category: "Game of Life",
      subcategory: "spaceships",
      code: [
        "X--X-",
        "----X",
        "X---X",
        "-XXXX"
      ],
      button: undefined
    },
    {
      name: "Middle Spaceship",
	  titleText: "Spaceship, c/2 (2c/4)",
      category: "Game of Life",
      subcategory: "spaceships",
      code: [
        "--X---",
        "X---X-",
        "-----X",
        "X----X",
        "-XXXXX"
      ],
      button: undefined
    },
    {
      name: "Heavy Spaceship",
	  titleText: "Spaceship, c/2 (2c/4)",
      category: "Game of Life",
      subcategory: "spaceships",
      code: [
        "--XX---",
        "X----X-",
        "------X",
        "X-----X",
        "-XXXXXX"
      ],
      button: undefined
    },
    {
      name: "Copperhead",
	  titleText: "Spaceship, c/10",
      category: "Game of Life",
      subcategory: "spaceships",
      code: [
        "---XXX-XX---",
        "--XXX----X-X",
        "XX-X----X--X",
        "XX-X----X--X",
        "--XXX----X-X",
        "---XXX-XX---"
      ],
      button: undefined
    },
    {
      name: "Loafer",
	  titleText: "Spaceship, c/7",
      category: "Game of Life",
      subcategory: "spaceships",
      code: [
        "XX-X--XX-",
        "-XX--X--X",
        "-----X-X-",
        "------X--",
        "X--------",
        "XXX------",
        "---X-----",
        "--X------",
        "XX-------"
      ],
      button: undefined
    },
    {
      name: "Blinker Puffer",
	  titleText: "Puffer, p8, c/2 (4c/8)",
      category: "Game of Life",
      subcategory: "puffers",
      code: [
        "-----X---",
        "---X---X-",
        "--------X",
        "---X----X",
        "----XXXXX",
        "---------",
        "---------",
        "---------",
        "------XX-",
        "---XXX-XX",
        "----XXXX-",
        "-----XX--",
        "---------",
        "--XX-----",
        "X----X---",
        "------X--",
        "X-----X--",
        "-XXXXXX--"
      ],
      button: undefined
    },
    {
      name: "Weekender",
	  titleText: "Spaceship, 2c/7",
      category: "Game of Life",
      subcategory: "spaceships",
      code: [
        "--------X--",
        "------XX-XX",
        "---X-X--X--",
        "---X-------",
        "-X-X-------",
        "X--X-------",
        "X---XX-----",
        "----XX-----",
        "----XX-----",
        "X---XX-----",
        "X--X-------",
        "-X-X-------",
        "---X-------",
        "---X-X--X--",
        "------XX-XX",
        "--------X--"
      ],
      button: undefined
    },
    {
      name: "Pufferfish",
	  titleText: "Puffer, p12, c/2 (6c/12)",
      category: "Game of Life",
      subcategory: "puffers",
      code: [
        "---XX-------",
        "---X-----X--",
        "-----X---XX-",
        "-X------X-XX",
        "X-----X-X-X-",
        "-X---X--XX--",
        "--XXX-------",
        "------------",
        "--XXX-------",
        "-X---X--XX--",
        "X-----X-X-X-",
        "-X------X-XX",
        "-----X---XX-",
        "---X-----X--",
        "---XX-------"
      ],
      button: undefined
    },
    {
      name: "Dart",
	  titleText: "Spaceship, c/3",
      category: "Game of Life",
      subcategory: "spaceships",
      code: [
        "-X--------",
        "X-X-------",
        "--XX------",
        "X---------",
        "X---X-----",
        "----X--X--",
        "XXXX--X-X-",
        "------X--X",
        "XXXX--X-X-",
        "----X--X--",
        "X---X-----",
        "X---------",
        "--XX------",
        "X-X-------",
        "-X--------"
      ],
      button: undefined
    },
    {
      name: "x66",
	  titleText: "Spaceship, c/2 (2c/4)",
      category: "Game of Life",
      subcategory: "spaceships",
      code: [
        "------X--",
        "-------XX",
        "X--XXX--X",
        "-XXX----X",
        "-XX--XXX-",
        "---------",
        "-XX--XXX-",
        "-XXX----X",
        "X--XXX--X",
        "-------XX",
        "------X--"
      ],
      button: undefined
    },
	{
      name: "Toad Flipper/Escorter",
	  titleText: "Spaceship, c/2 (2c/4)",
      category: "Game of Life",
      subcategory: "spaceships",
      code: [
        "-----XXX--",
		"---XXXXXX-",
		"--XXXXX-XX",
		"--X----XX-",
		"----------",
		"----X-----",
		"-X-XX-----",
		"--XXX-----",
		"-----XX---",
		"----X-XX--",
		"-------XX-",
		"-----X-X--",
		"------X---",
		"-----X----",
		"--XX------",
		"---X------",
		"-----XXX--",
		"--X-XXXXX-",
		"XX--XXX-XX",
		"-------XX-",
		"----------",
		"----------",
		"-----X----",
		"--X--X----",
		"--X--X----",
		"----X-----",
		"----------",
		"-----XXX--",
		"---XXXXXX-",
		"--XXXXX-XX",
		"--X----XX-",
		"----------",
		"----X-----",
		"-X-XX-----",
		"--XXX-----",
		"-----XX---",
		"----X-XX--",
		"-------XX-",
		"-----X-X--",
		"------X---",
		"-----X----",
		"--XX------",
		"---X------",
		"-----XXX--",
		"--X-XXXXX-",
		"XX--XXX-XX",
		"-------XX-"
      ],
      button: undefined
    },
	{
      name: "Clogged Backrake", // (My name, catalogued is nameless) (variation on Backrake 1, but with one pattern changed so that the gliders are no longer emitted)
	  titleText: "Spaceship, c/2 (2c/4)",
      category: "Game of Life",
      subcategory: "spaceships",
      code: [
        "----------X-X-----",
		"----------X--X----",
		"-------------XX---",
		"---------------X--",
		"-------------XXXX-",
		"-----X------X----X",
		"-----X-XX-----X--X",
		"--------X-----X--X",
		"--------X-------X-",
		"----------X-XXXX--",
		"----------X---X---",
		"--XX---------X----",
		"X----X---XXXXX----",
		"------X-----------",
		"X-----X--XXXXX----",
		"-XXXXXX------X----",
		"----------X---X---",
		"----------X-XXXX--",
		"--------X-------X-",
		"--------X-----X--X",
		"-----X-XX-----X--X",
		"-----X------X----X",
		"-------------XXXX-",
		"---------------X--",
		"-------------XX---",
		"----------X--X----",
		"----------X-X-----"
      ],
      button: undefined
    },
    {
      name: "Big Glider",
	  titleText: "Spaceship, c/4",
      category: "Game of Life",
      subcategory: "spaceships",
      code: [
        "----X--X----------",
        "----XXX-X---------",
        "---XX-------------",
        "--X-XX---X--------",
        "XXXX---XX-X-------",
        "-X-X---XXXX-------",
        "-X-------X--------",
        "X---XX----X-XX----",
        "-X--XX------X-X---",
        "---X-XX---------X-",
        "----XX-X-----X--X-",
        "---------------XX-",
        "-------XX--------X",
        "-------X--X----X-X",
        "--------X-------XX",
        "-----------X-X----",
        "---------XXX--X---",
        "------------XXX---"
      ],
      button: undefined
    },
    {
      name: "Sir Robin",
	  titleText: "Spaceship, (2, 1)c/6",
      category: "Game of Life",
      subcategory: "spaceships",
      code: [
        "------X---X-XX-----------------------------------------------------------------",
		"------XXX-X---X------------------XXX-------------------------------------------",
		"-----XX----XXX---XX---------------XX--XX---------------------------------------",
		"-----X---X------XX--------------X--X-X-----------------------------------------",
		"X---X----XX-X---X--X-X-----------X----X-X--------------------------------------",
		"-X-XXX-----XXX--X----X-------------X----XX-------------------------------------",
		"-X---XXXX-X-XX---X-XX-X--XXX--X---X-X----X-X-XX--------------------------------",
		"------XXX--X--XX-----XX--XX-X---XX--XX---X-X-XX--------------------------------",
		"-------XX--X--XX-----XX--XX-X-X-XX----X--X-----------XX------------------------",
		"------------X-X------XX--X--X-XX-X-----X-XX----X-----X-X-----------------------",
		"---------------------X-X-XX-XX---XX---XX--XX---X-----X---X---------------------",
		"--------------------X-----XXX-----X-XX-X----X--X-----X---XXXX------------------",
		"--------------------X---XXX--------X---------XX---X--X---X-----XXX-------------",
		"--------------------X------------------------X-XXX-X------X--X-----------------",
		"----------------------X----------------------XXX---X----------X-X-XX-----------",
		"---------------------------------------------XX--XX---X---XX-XXXX-X-X--XX------",
		"----------------------------------------------X-XXX-X-----X-----X-------X------",
		"---------------------------------------------XX--XX-X------X-X----X-----XXX----",
		"----------------------------------------------------XX------X-X-X---X----XX----",
		"-----------------------------------------------X-X----XX-X-XX--XXX-XX-XX-XX----",
		"------------------------------------------------X-----------XXXX-X----XX-XX----",
		"-------------------------------------------------------------------------------",
		"--------------------------------------------------------------------X------XX--",
		"--------------------------------------------------------------------X------X-X-",
		"--------------------------------------------------------------------X---X--X---",
		"---------------------------------------------------------------------X-X-X----X",
		"-----------------------------------------------------------------------X-X--XXX",
		"-------------------------------------------------------------------X---X--X----",
		"-------------------------------------------------------------------X---X-XX----",
		"---------------------------------------------------------------------X--X------",
		"----------------------------------------------------------------------X--------"
      ],
      button: undefined
    },
    {
      name: "Figure 8",
	  titleText: "Oscillator, p8",
      category: "Game of Life",
      subcategory: "oscillators",
      code: [
        "XXX---",
        "XXX---",
        "XXX---",
        "---XXX",
        "---XXX",
        "---XXX"
      ],
      button: undefined
    },
    {
      name: "Pentadecathlon",
	  titleText: "Oscillator, p15",
      category: "Game of Life",
      subcategory: "oscillators",
      code: [
        "--X----X--",
        "XX-XXXX-XX",
        "--X----X--"
      ],
      button: undefined
    },
    {
      name: "Snacker",
	  titleText: "Oscillator, p9",
      category: "Game of Life",
      subcategory: "oscillators",
      code: [
        "XX----------------XX",
        "-X----------------X-",
        "-X-X------------X-X-",
        "--XX------------XX--",
        "-------X----X-------",
        "-----XX-XXXX-XX-----",
        "-------X----X-------",
        "--XX------------XX--",
        "-X-X------------X-X-",
        "-X----------------X-",
        "XX----------------XX"
      ],
      button: undefined
    },
    {
      name: "Tumbler",
	  titleText: "Oscillator, p14",
      category: "Game of Life",
      subcategory: "oscillators",
      code: [
        "-X-----X-",
        "X-X---X-X",
        "X--X-X--X",
        "--X---X--",
        "--XX-XX--"
      ],
      button: undefined
    },
    {
      name: "Star",
	  titleText: "Oscillator, p3",
      category: "Game of Life",
      subcategory: "oscillators",
      code: [
        "-----X-----",
        "----XXX----",
        "--XXX-XXX--",
        "--X-----X--",
        "-XX-----XX-",
        "XX-------XX",
        "-XX-----XX-",
        "--X-----X--",
        "--XXX-XXX--",
        "----XXX----",
        "-----X-----"
      ],
      button: undefined
    },
    {
      name: "Toad Flipper",
	  titleText: "Oscillator, p60",
      category: "Game of Life",
      subcategory: "oscillators",
      code: [
        "-X--------------X-",
        "-X--------------X-",
        "X-X------------X-X",
        "-X--------------X-",
        "-X------X-------X-",
        "-X------XX------X-",
        "-X------XX------X-",
        "X-X------X-----X-X",
        "-X--------------X-",
        "-X--------------X-"
      ],
      button: undefined
    },
    {
      name: "Gourmet",
	  titleText: "Oscillator, p32",
      category: "Game of Life",
      subcategory: "oscillators",
      code: [
        "----------XX--------",
        "----------X---------",
        "----XX-XX-X----XX---",
        "--X--X-X-X-----X----",
        "--XX----X--------X--",
        "----------------XX--",
        "--------------------",
        "----------------XX--",
        "X---------XXX--X-X--",
        "XXX-------X-X---X---",
        "---X------X-X----XXX",
        "--X-X--------------X",
        "--XX----------------",
        "--------------------",
        "--XX----------------",
        "--X--------X----XX--",
        "----X-----X-X-X--X--",
        "---XX----X-XX-XX----",
        "---------X----------",
        "--------XX----------"
      ],
      button: undefined
    },
    {
      name: "Phoenix Heart",
	  titleText: "Oscillator, p2",
      category: "Game of Life",
      subcategory: "oscillators",
      code: [
        "---X-------X----",
        "---X-X-----X-X--",
        "-X-----X-X------",
        "-------X------XX",
        "XX--------------",
        "--------------X-",
        "--X-------------",
        "------------XX--",
        "--XX------------",
        "------------X---",
        "----X-----------",
        "----------XX----",
        "----XX----------",
        "----------X-----",
        "------X-X-------",
        "--------X-------"
      ],
      button: undefined
    },
    {
      name: "Queen Bee Shuttle",
	  titleText: "Oscillator, p30",
      category: "Game of Life",
      subcategory: "oscillators",
      code: [
        "---------X------------",
        "-------X-X------------",
        "------X-X-------------",
        "XX---X--X-------------",
        "XX----X-X-------------",
        "-------X-X--------XX--",
        "---------X--------X-X-",
        "--------------------X-",
        "--------------------XX"
      ],
      button: undefined
    },
    {
      name: "Pulsar",
	  titleText: "Oscillator, p3",
      category: "Game of Life",
      subcategory: "oscillators",
      code: [
        "--XXX---XXX--",
        "-------------",
        "X----X-X----X",
        "X----X-X----X",
        "X----X-X----X",
        "--XXX---XXX--",
        "-------------",
        "--XXX---XXX--",
        "X----X-X----X",
        "X----X-X----X",
        "X----X-X----X",
        "-------------",
        "--XXX---XXX--"
      ],
      button: undefined
    },
    {
      name: "Glider Train",
	  titleText: "Puffer/Rake, p64, c/2 (32c/64)",
      category: "Game of Life",
      subcategory: "puffers",
      code: [
		"---------------------------XX--------------",
        "-------------------------X----X------------",
        "-------------------------------X-----------",
        "--X----------------------X-----X-----------",
        "X---X---------------------XXXXXX-----XXXXXX",
        "-----X------------------------------X-----X",
        "X----X------------------------------------X",
        "-XXXXX------------------------------X----X-",
        "--------------------------------------XX---",
        "-------------------------------------------",
        "-------------------------------------X-----",
        "------------------------------------X------",
        "-----------------------------------XX---XX-",
        "-----------------------------------X-X---XX",
        "------------------------------------X---XX-",
        "----------------------------------------X--",
        "-------------------------------------------",
        "----------------------------------------X--",
        "------------------------------------X---XX-",
        "-----------------------------------X-X---XX",
        "-----------------------------------XX---XX-",
        "------------------------------------X------",
        "-------------------------------------X-----",
        "-------------------------------------------",
        "--------------------------------------XX---",
        "-XXXXX------------------------------X----X-",
        "X----X------------------------------------X",
        "-----X------------------------------X-----X",
        "X---X---------------------XXXXXX-----XXXXXX",
        "--X----------------------X-----X-----------",
        "-------------------------------X-----------",
        "-------------------------X----X------------",
		"---------------------------XX--------------"
      ],
      button: undefined
    },
    {
      name: "One Per Generation",
	  titleText: "Wickstretcher, p4, c/4",
      category: "Game of Life",
      subcategory: "puffers",
      code: [
        "------X--------",
		"-----X-X-------",
		"------X--------",
		"---------XX----",
		"------X-XXXX---",
		"-------XX----X-",
		"-X---X-X------X",
		"X-X--XX-----XXX",
		"-X---XX--------",
		"---------------",
		"---X-----------",
		"---XX----------",
		"------X--------",
		"-------X-------",
		"-----XXX-------"
      ],
      button: undefined
    },
    {
      name: "Space Rake",
	  titleText: "Rake, p20, c/2 (10c/20)",
      category: "Game of Life",
      subcategory: "puffers",
      code: [
        "-XXXX-----------------",
        "X---X------------X--X-",
        "----X----------------X",
        "X--X-------------X---X",
        "------------------XXXX",
        "----------------------",
        "----------------------",
        "----------------------",
        "-----------X----XX----",
        "--------XXXX---XX-XX--",
        "-------XXXXX----X--X--",
        "------X---------X--X--",
        "-------XX--------XX---",
        "--------X-------------",
        "----------------------",
        "----------XX-----X--X-",
        "---------XXXX--------X",
        "---------XX-XX---X---X",
        "-----------XX-----XXXX"
      ],
      button: undefined
    },
	{
      name: "Backrake", // Variation on catalogued name of "Backrake 1"
	  titleText: "Rake, p8, c/2 (4c/8)",
      category: "Game of Life",
      subcategory: "puffers",
      code: [
        "----------X-X-----",
		"----------X--X----",
		"-------------XX---",
		"---------------X--",
		"-------------XXXX-",
		"------------X----X",
		"------XXX-----X--X",
		"--------X-----X--X",
		"------X-X-------X-",
		"----------X-XXXX--",
		"-------X--X---X---",
		"--XX---------X----",
		"X----X---XXXXX----",
		"------X-----------",
		"X-----X--XXXXX----",
		"-XXXXXX------X----",
		"----------X---X---",
		"----------X-XXXX--",
		"--------X-------X-",
		"--------X-----X--X",
		"-----X-XX-----X--X",
		"-----X------X----X",
		"-------------XXXX-",
		"---------------X--",
		"-------------XX---",
		"----------X--X----",
		"----------X-X-----"
      ],
      button: undefined
    },
    {
      name: "Max",
	  titleText: "Spacefiller, p4, c/2 (2c/4)",
      category: "Game of Life",
      subcategory: "spacefillers",
      code: [
        "------------------X--------",
        "-----------------XXX-------",
        "------------XXX----XX------",
        "-----------X--XXX--X-XX----",
        "----------X---X-X--X-X-----",
        "----------X----X-X-X-X-XX--",
        "------------X----X-X---XX--",
        "XXXX-----X-X----X---X-XXX--",
        "X---XX-X-XXX-XX---------XX-",
        "X-----XX-----X-------------",
        "-X--XX-X--X--X-XX----------",
        "-------X-X-X-X-X-X-----XXXX",
        "-X--XX-X--X--X--XX-X-XX---X",
        "X-----XX---X-X-X---XX-----X",
        "X---XX-X-XX--X--X--X-XX--X-",
        "XXXX-----X-X-X-X-X-X-------",
        "----------XX-X--X--X-XX--X-",
        "-------------X-----XX-----X",
        "-XX---------XX-XXX-X-XX---X",
        "--XXX-X---X----X-X-----XXXX",
        "--XX---X-X----X------------",
        "--XX-X-X-X-X----X----------",
        "-----X-X--X-X---X----------",
        "----XX-X--XXX--X-----------",
        "------XX----XXX------------",
        "-------XXX-----------------",
        "--------X------------------"
      ],
      button: undefined
    },
    {
      name: "Max Grandparent",
	  titleText: "Spacefiller, p4, c/2 (2c/4)",
      category: "Game of Life",
      subcategory: "spacefillers",
      code: [
        "X-X-X-XX---X-X--XXX---XX-",
        "XXX-X---X---X---XX---XXX-",
        "---XXXX--X-XX---X-X-X-X--",
        "--XXX-X--XX-X-XXX---X-X-X",
        "XXXXXXXX--XX-XX--X-XX--X-",
        "--XX-X-XX-X-X---X-X-X-XXX",
        "XX--X--XX----X---X------X",
        "X--X-X---X-XXX-XXXX--X-X-",
        "X--X------XX--XXXXX---XXX",
        "--XX-X-X-XXX--X----XXX---",
        "XX----X-X-------XXXXXX-XX",
        "---XX-X--XX-XX-XX--X-XX-X",
        "X---X--XXXX-XXX--X------X",
        "X-XX----X-------XXX-XX---",
        "XX-X-X--XX-X-X---X---X-XX",
        "---XX--X-X---X--X--X-XX--",
        "XX-XXXX-XX-----XX-X-----X",
        "-XX--XXX--XX-X-XX---XX--X",
        "X--X----X-XX-------XXX-XX",
        "X--XX--XX-XXXX------XXX--",
        "--X-X-X-X---------X---X--",
        "------X-X-XX---XXX----XXX",
        "XXX-XX-X--XX---X---XX-XX-",
        "-XXX-X-XX--X--X-X-----X-X",
        "XXX---XXX--XX-----XX--X--"
      ],
      button: undefined
    },
    {
      name: "Holzwart Spacefiller",
	  titleText: "Spacefiller, p4, c/2 (2c/4)",
      category: "Game of Life",
      subcategory: "spacefillers",
      code: [
        "--------------------XXX---XXX--------------------",
        "-------------------X--X---X--X-------------------",
        "XXXX------------------X---X------------------XXXX",
        "X---X-----------------X---X-----------------X---X",
        "X--------X------------X---X------------X--------X",
        "-X--X--XX--X-------------------------X--XX--X--X-",
        "------X-----X-------XXX---XXX-------X-----X------",
        "------X-----X--------X-----X--------X-----X------",
        "------X-----X--------XXXXXXX--------X-----X------",
        "-X--X--XX--X--XX----X-------X----XX--X--XX--X--X-",
        "X--------X---XX----XXXXXXXXXXX----XX---X--------X",
        "X---X---------XX-----------------XX---------X---X",
        "XXXX-----------XXXXXXXXXXXXXXXXXXX-----------XXXX",
        "----------------X-X-----------X-X----------------",
        "-------------------XXXXXXXXXXX-------------------",
        "-------------------X---------X-------------------",
        "--------------------XXXXXXXXX--------------------",
        "------------------------X------------------------",
        "--------------------XXX---XXX--------------------",
        "----------------------X---X----------------------",
        "-------------------------------------------------",
        "---------------------XXX-XXX---------------------",
        "---------------------XXX-XXX---------------------",
        "--------------------X-XX-XX-X--------------------",
        "--------------------XXX---XXX--------------------",
        "---------------------X-----X---------------------"
      ],
      button: undefined
    },
    {
      name: "Space Non-Filler",
	  titleText: "Spacefiller, p4, c/2 (2c/4)",
      category: "Game of Life",
      subcategory: "spacefillers",
      code: [
        "-------------------XXX---------------",
        "------------------X--X---------------",
        "------------XXX------X----XXX--------",
        "------------X--X-X---X----X--X-------",
        "------------X--X-X---X----X--X-------",
        "----------X----------X--X-X-XXX------",
        "----------XX--XX--X-X----X-----X-----",
        "--------X----------------XX--XXX-----",
        "--------XXX-X-XX----------X------X---",
        "------X--------X---------X-X---XXX---",
        "------XXX-----X----------X--------X--",
        "---X-X-------------------------X-XXX-",
        "--XXXXX-X--------------------------X-",
        "-XX------X---------------------XXXXX-",
        "XX----XX------------------X-X--------",
        "-X-X---X--X---------------X--X---X-X-",
        "--------X-X------------------XX----XX",
        "-XXXXX---------------------X------XX-",
        "-X--------------------------X-XXXXX--",
        "-XXX-X-------------------------X-X---",
        "--X--------X----------X-----XXX------",
        "---XXX---X-X---------X--------X------",
        "---X------X----------XX-X-XXX--------",
        "-----XXX--XX----------------X--------",
        "-----X-----X----X-X--XX--XX----------",
        "------XXX-X-X--X----------X----------",
        "-------X--X----X---X-X--X------------",
        "-------X--X----X---X-X--X------------",
        "--------XXX----X------XXX------------",
        "---------------X--X------------------",
        "---------------XXX-------------------"
      ],
      button: undefined
    },
    {
      name: "Quasar",
	  titleText: "Oscillator, p3",
      category: "Game of Life",
      subcategory: "oscillators",
      code: [
        "----------XXX---XXX----------",
        "-----------------------------",
        "--------X----X-X----X--------",
        "--------X----X-X----X--------",
        "--------X----X-X----X--------",
        "----------XXX---XXX----------",
        "-----------------------------",
        "--------XXX-------XXX--------",
        "--XXX--X----X---X----X--XXX--",
        "-------X----X---X----X-------",
        "X----X-X----X---X----X-X----X",
        "X----X-----------------X----X",
        "X----X--XXX-------XXX--X----X",
        "--XXX-------------------XXX--",
        "-----------------------------",
        "--XXX-------------------XXX--",
        "X----X--XXX-------XXX--X----X",
        "X----X-----------------X----X",
        "X----X-X----X---X----X-X----X",
        "-------X----X---X----X-------",
        "--XXX--X----X---X----X--XXX--",
        "--------XXX-------XXX--------",
        "-----------------------------",
        "----------XXX---XXX----------",
        "--------X----X-X----X--------",
        "--------X----X-X----X--------",
        "--------X----X-X----X--------",
        "-----------------------------",
        "----------XXX---XXX----------"
      ],
      button: undefined
    },
    {
      name: "Kok's Galaxy",
	  titleText: "Oscillator, p8",
      category: "Game of Life",
      subcategory: "oscillators",
      code: [
        "XXXXXX-XX",
        "XXXXXX-XX",
        "-------XX",
        "XX-----XX",
        "XX-----XX",
        "XX-----XX",
        "XX-------",
        "XX-XXXXXX",
        "XX-XXXXXX"
      ],
      button: undefined
    },
    {
      name: "Pööpenfärten", // Name Credit (and thought to be discoverer): David French (Catalogued name is "Blocker")
	  titleText: "Oscillator, p8",
      category: "Game of Life",
      subcategory: "oscillators",
      code: [
        "-XX-",
        "X--X",
        "X---",
        "X---",
        "X-XX",
        "--XX",
        "----",
        "----",
        "-XX-",
        "-XX-"
      ],
      button: undefined
    },
    {
      name: "Twirling T-Tetsons II",
	  titleText: "Oscillator, p60",
      category: "Game of Life",
      subcategory: "oscillators",
      code: [
        "-------XX---XX----------",
        "------X-------X---------",
        "---------X-X------------",
        "-------XX---XX----------",
        "------------------------",
        "------------------------",
        "------------------------",
        "---------------------XXX",
        "--------------------XXX-",
        "-------------X----------",
        "XXX---------XXX---------",
        "-XXX--------------------",
        "--------------------XXX-",
        "---------------------XXX",
        "------------------------",
        "-XXX--------------------",
        "XXX---------XXX---------",
        "-------------X----------",
        "------------------------",
        "------------------------",
        "----------XX---XX-------",
        "------------X-X---------",
        "---------X-------X------",
        "----------XX---XX-------"
      ],
      button: undefined
    },
	{
      name: "Blender", // (My name, catalogued name is just "132P7")
	  titleText: "Oscillator, p7",
      category: "Game of Life",
      subcategory: "oscillators",
      code: [
        "----X---XX---X----",
		"---X-X-X--X-X-X---",
		"---X-X------X-X---",
		"-XXX-X------X-XXX-",
		"X----X-XXXX-X----X",
		"-XXX-X-XXXX-X-XXX-",
		"---X--XX--XX--X---",
		"------X----X------",
		"-------X--X-------",
		"--------XX--------",
		"---X----------X---",
		"-XXX----------XXX-",
		"X-----XXXXXX-----X",
		"-XXX----------XXX-",
		"---X----------X---",
		"--------XX--------",
		"-------X--X-------",
		"------X----X------",
		"---X--XX--XX--X---",
		"-XXX-X-XXXX-X-XXX-",
		"X----X-XXXX-X----X",
		"-XXX-X------X-XXX-",
		"---X-X------X-X---",
		"---X-X-X--X-X-X---",
		"----X---XX---X----"
      ],
      button: undefined
    },
	{
      name: "Swiveller", // (My name, catalogued name is just "38P7.2"
	  titleText: "Oscillator, p7",
      category: "Game of Life",
      subcategory: "oscillators",
      code: [
        "----X---X----",
		"X--X-X-X-X--X",
		"X-X--X-X--X-X",
		"-X--XX-XX--X-",
		"-----X-X-----",
		"--XX-----XX--",
		"--X-------X--",
		"----X---X----",
		"-------------",
		"-X--X---X--X-",
		"--XX-----XX--"
      ],
      button: undefined
    },
	{
      name: "Toad Worker Bee", // (My name, catalogued name is just "P6 Worker Bee"
	  titleText: "Oscillator, p6",
      category: "Game of Life",
      subcategory: "oscillators",
      code: [
        "XXX----------XXX",
		"-XXX-X----X-XXX-",
		"------X--X------",
		"-------XX-------",
		"------X--X------",
		"-XXX-X----X-XXX-",
		"XXX----------XXX"
      ],
      button: undefined
    },
    {
      name: "Gosper Glider Gun",
	  titleText: "Gun, p30",
      category: "Game of Life",
      subcategory: "guns",
      code: [
        "------------------------X-----------",
        "----------------------X-X-----------",
        "------------XX------XX------------XX",
        "-----------X---X----XX------------XX",
        "XX--------X-----X---XX--------------",
        "XX--------X---X-XX----X-X-----------",
        "----------X-----X-------X-----------",
        "-----------X---X--------------------",
        "------------XX----------------------"
      ],
      button: undefined
    },
    {
      name: "Simkin Glider Gun",
	  titleText: "Gun, p120, 2-Barrel",
      category: "Game of Life",
      subcategory: "guns",
      code: [
        "XX-----XX------------------------",
        "XX-----XX------------------------",
        "---------------------------------",
        "----XX---------------------------",
        "----XX---------------------------",
        "---------------------------------",
        "---------------------------------",
        "---------------------------------",
        "---------------------------------",
        "----------------------XX-XX------",
        "---------------------X-----X-----",
        "---------------------X------X--XX",
        "---------------------XXX---X---XX",
        "--------------------------X------"
      ],
      button: undefined
    },
    {
      name: "Bolt-Action Rifle", // (My name, catalogued name is "New Gun")
	  titleText: "Gun, p46",
      category: "Game of Life",
      subcategory: "guns",
      code: [
        "-------------------------XX-----XX",
        "-------------------------XX-----XX",
        "----------------------------------",
        "----------------------------------",
        "----------------------------------",
        "----------------------------------",
        "----------------------------------",
        "----------------------------------",
        "----------------------------------",
        "----------------------------------",
        "----------------------------------",
        "----------------------------------",
        "----------------------------------",
        "---------------------------XX-XX--",
        "--------------------------X-----X-",
        "----------------------------------",
        "-------------------------X-------X",
        "-------------------------X--X-X--X",
        "-------------------------XXX---XXX",
        "----------------------------------",
        "----------------------------------",
        "----------------------------------",
        "----------------------------------",
        "-----------------X----------------",
        "XX---------------XX---------------",
        "XX----------------XX--------------",
        "-------------XX--XX---------------",
        "----------------------------------",
        "----------------------------------",
        "----------------------------------",
        "-------------XX--XX---------------",
        "XX----------------XX-------XX-----",
        "XX---------------XX--------XX-----",
        "-----------------X----------------"
      ],
      button: undefined
    },
    {
      name: "B-52 Bomber",
	  titleText: "Oscillator, p104, 2-Barrel",
      category: "Game of Life",
      subcategory: "guns",
      code: [
        "-XX------------------------------------",
		"-XX-----------------X------------------",
		"-------------------X-X------------X-X--",
		"--------------------X------------X-----",
		"XX-------XX-----------------------X--X-",
		"XX-X-----XX-----------------------X-X-X",
		"---X-----------------------X-------X--X",
		"---X-----------------------XX-------XX-",
		"X--X-----------------XX-----X----------",
		"-XX------------------X-----------------",
		"---------------------XXX---------------",
		"------------------------------------XX-",
		"------------------------------------XX-",
		"-XX------------------------------------",
		"X--X-----------------------------------",
		"X-X-X----------------X-X----XX-----XX--",
		"-X--X-----------------XX----XX-----XX-X",
		"-----X------------X---X---------------X",
		"--X-X------------X-X------------------X",
		"------------------X----------------X--X",
		"------------------------------------XX-"
      ],
      button: undefined
    },
    {
      name: "Light Spaceship Synth",
	  titleText: "Glider Synthesis, 3G", // _G is number of gliders
      category: "Game of Life",
      subcategory: "glider-synthesis",
      code: [
        "----X---",
        "---X----",
        "---XXX--",
        "--------",
        "--------",
        "--------",
        "------X-",
        "XXX--XX-",
        "--X--X-X",
        "-X------"
      ],
      button: undefined
    },
    {
      name: "Middle Spaceship Synth",
	  titleText: "Glider Synthesis, 3G",
      category: "Game of Life",
      subcategory: "glider-synthesis",
      code: [
        "----X------X",
        "-----X---XX-",
        "---XXX----XX",
        "------------",
        "------------",
        "XXX---------",
        "--X---------",
        "-X----------"
      ],
      button: undefined
    },
    {
      name: "Heavy Spaceship Synth",
	  titleText: "Glider Synthesis, 3G",
      category: "Game of Life",
      subcategory: "glider-synthesis",
      code: [
        "X---------",
        "-XX-------",
        "XX--------",
        "-------XX-",
        "-------X-X",
        "--XX---X--",
        "--X-X-----",
        "--X-------"
      ],
      button: undefined
    },
    {
      name: "Pentadecathlon Synth",
	  titleText: "Glider Synthesis, 3G",
      category: "Game of Life",
      subcategory: "glider-synthesis",
      code: [
        "------X---",
        "------X-X-",
        "------XX--",
        "----------",
        "XXX-------",
        "--X-------",
        "-X-----XX-",
        "--------XX",
        "-------X--"
      ],
      button: undefined
    },
    {
      name: "Loafer Synth",
	  titleText: "Glider Synthesis, 8G",
      category: "Game of Life",
      subcategory: "glider-synthesis",
      code: [
        "X---------------------------------",
        "-XX-------------------------------",
        "XX--------------------------------",
        "------------------------X---------",
        "-----------------------X--------X-",
        "-----------------------XXX-----X--",
        "-------------------------------XXX",
        "----------------------------------",
        "----------------------------------",
        "----------------------------X-----",
        "---------------------------X------",
        "---------------------------XXX----",
        "-------X-X------------------------",
        "-------XX-------------------------",
        "--------X-------------------------",
        "----------------------------------",
        "----X-X---------------------------",
        "-----XX---------------------------",
        "-----X----------------------------",
        "XXX-------------------------------",
        "--X-------------------------------",
        "-X--------------------------------",
        "----------------------------------",
        "----------------------------------",
        "----------------------------------",
        "----------------------------------",
        "----------------------------------",
        "----------------------------------",
        "---------------------------XX-----",
        "--------------------------XX------",
        "----------------------------X-----"
      ],
      button: undefined
    },
    {
      name: "x66 Synth",
	  titleText: "Glider Synthesis, 13G",
      category: "Game of Life",
      subcategory: "glider-synthesis",
      code: [
        "-----------------X---------",
        "------------------X--------",
        "----------------XXX--------",
        "---------------------------",
        "----------X----------------",
        "--------X-X----------------",
        "---------XX----X-X---------",
        "----------------XX---------",
        "----------------X----------",
        "-------------------X-------",
        "----------X--------X-X----X",
        "--------X-X--------XX---XX-",
        "---------XX--------------XX",
        "---------------------------",
        "---------------------------",
        "---------------------------",
        "---------------------------",
        "---------XX----------------",
        "--------X-X----------------",
        "----------X----------------",
        "-------------------------XX",
        "-------------------XX---XX-",
        "-------------------X-X----X",
        "XXX----------------X-------",
        "--X-------------X----------",
        "-X---XXX--------XX---------",
        "-------X-------X-X---------",
        "------X--------------------",
        "---------------------------",
        "---------------------------",
        "----------------XXX--------",
        "------------------X--------",
        "-----------------X---------"
      ],
      button: undefined
    },
    {
      name: "Copperhead Synth",
	  titleText: "Glider Synthesis, 13G",
      category: "Game of Life",
      subcategory: "glider-synthesis",
      code: [
        "-------------X-X------------------------------",
        "--------------XX----------------------------X-",
        "----------X---X----------------------------X--",
        "-----------X-------------------------------XXX",
        "---------XXX----------------------------------",
        "----------------------------------------------",
        "-------X--------------------------------------",
        "--------X-------------------------------------",
        "------XXX-------------------------------------",
        "----------------------------------------------",
        "----------------------------------------------",
        "-----X----------------------------------------",
        "---X-X---X------------------------------------",
        "----XX----XX----------------------------------",
        "---------XX-----------------------------------",
        "----------------------------------------------",
        "----------------------------------------------",
        "----------------------------------------------",
        "----------------------------------------------",
        "----------------------------------------------",
        "----------------------------------------------",
        "----------------------------------------------",
        "----------------------------------------------",
        "-----------------------------X----------------",
        "------------------------------X---------------",
        "----------------------------XXX---------------",
        "----------------------------------------------",
        "-------------------------------X--------------",
        "-------------------------------XX-------------",
        "------------------------------X-X-------------",
        "----------------------------------------------",
        "----------------------------------------------",
        "----------------------------------------------",
        "---------------------------X------------------",
        "-------------------------X-X------------------",
        "--------------------------XX------------------",
        "----------------------------------------------",
        "----------------------------------------------",
        "--------------------------X-------------------",
        "-------------XX-----------XX------------------",
        "--------------XX---------X-X------------------",
        "-------------X--------------------------------",
        "-XX-------------------------------------------",
        "X-X-------------------------------------------",
        "--X-------------------------------------------",
        "------XXX-------------------------------------",
        "--------X-------------------------------------",
        "-------X--------------------------------------"
      ],
      button: undefined
    },
    {
      name: "Two-Glider Mess",
	  titleText: "Glider Synthesis, 2G",
      category: "Game of Life",
      subcategory: "glider-synthesis",
      code: [
        "--X---------",
        "X-X---------",
        "-XX---------",
        "-----------X",
        "---------XX-",
        "----------XX"
      ],
      button: undefined
    },
	
	// Move
	
	{
      name: "Jellyfish", // (Catalogued name)
	  titleText: "Spaceship, c/7",
      category: "Move",
      code: [
        "--X-",
		"---X",
		"X-X-",
		"-X--"
      ],
      button: undefined
    },
	{
      name: "Silverfish", // (My name, catalogued name is unnamed)
	  titleText: "Spaceship, c/4",
      category: "Move",
      code: [
        "X----XX",
		"XXX-XXX",
		"-X--XXX",
		"-----XX"
      ],
      button: undefined
    },
	{
      name: "Space Invader", // (My name, catalogued name is unnamed) (Several of its phases remind me of the alien spaceships in Space Invaders, Galaga, etc.)
	  titleText: "Spaceship, c/10",
      category: "Move",
      code: [
        "--XX---",
		"---XX--",
		"X--XX-X",
		"-X--XXX",
		"X--XX-X",
		"---XX--",
		"--XX---"
      ],
      button: undefined
    },
	{
      name: "Leapfrog", // (My name, catalogued name is unnamed) (The way it goes slowly and then pulls its "back" forwards quickly reminds me of a frog jumping)
	  titleText: "Spaceship, 4c/23",
      category: "Move",
      code: [
        "--X-----",
		"-XX-X---",
		"X-XX-X--",
		"------XX",
		"------XX",
		"X-XX-X--",
		"-XX-X---",
		"--X-----"
      ],
      button: undefined
    },
	{
      name: "Steam Train", // (My name, catalogued name is unnamed)
	  titleText: "Puffer, p170, 13c/170",
      category: "Move",
      code: [
        "-------XXX------",
		"-X---XXXX-------",
		"-X---X-XX-XX-X--",
		"X--XXXXX-XX-X-X-",
		"XX-----XXXXXXXXX",
		"XX-----XXXXXXXXX",
		"X--XXXXX-XX-X-X-",
		"-X---X-XX-XX-X--",
		"-X---XXXX-------",
		"-------XXX------"
      ],
      button: undefined
    },
	{
      name: "Inverter", // (My name, catalogued name is unnamed)
	  titleText: "Oscillator, p9",
      category: "Move",
      code: [
        "----XX----",
		"----XX----",
		"----XX----",
		"----XX----",
		"XXXX--XXXX",
		"XXXX--XXXX",
		"----XX----",
		"----XX----",
		"----XX----",
		"----XX----"
      ],
      button: undefined
    },
	
	// Day and Night
	
	{
      name: "Hovercar", // (My name, catalogued name is unnamed)
	  titleText: "Spaceship, c/2",
      category: "Day and Night",
      code: [
        "-X-X--",
		"--XXX-",
		"--XXXX",
		"--XXXX",
		"XXX---",
		"X-X-X-",
		"--X-X-",
		"X-XXX-",
		"X-X-X-",
		"--XX--"
      ],
      button: undefined
    },
	{
      name: "Plodder", // (My name, catalogued name is unnamed)
	  titleText: "Spaceship, c/7 (2c/14)",
      category: "Day and Night",
      code: [
        "---X--",
		"-X-XX-",
		"XXXXXX",
		"-X-XX-",
		"---X--"
      ],
      button: undefined
    },
	{
      name: "Jumper", // (My name, catalogued name is unnamed)
	  titleText: "Spaceship, c/3",
      category: "Day and Night",
      code: [
        "---X-",
		"---XX",
		"---XX",
		"XXX-X",
		"-XXX-"
      ],
      button: undefined
    },
	{
      name: "Blobfish", // (My name, catalogued name is unnamed)
	  titleText: "Spaceship, c/4",
      category: "Day and Night",
      code: [
        "----X--",
		"---X-X-",
		"----X-X",
		"---XXX-",
		"--XXXXX",
		"XXXXXX-",
		"XXXXX--",
		"-XXX---"
      ],
      button: undefined
    },
	{
      name: "Horsefly", // (My name, catalogued name is unnamed)
	  titleText: "Spaceship, c/6",
      category: "Day and Night",
      code: [
        "--XX------------",
		"-XXX------------",
		"-X-X------------",
		"--XXXX----------",
		"----X-X---------",
		"--XXXX----------",
		"--XXXX-XX---XXX-",
		"XXXXXXXXX----X-X",
		"--XXXX-XX---XXX-",
		"--XXXX----------",
		"----X-X---------",
		"--XXXX----------",
		"-X-X------------",
		"-XXX------------",
		"--XX------------"
      ],
      button: undefined
    },
	{
      name: "Ramship", // (My name, catalogued name is unnamed) (Looks like the horns on a ram)
	  titleText: "Spaceship, 2c/5",
      category: "Day and Night",
      code: [
        "------------X-------",
		"-------X----X-------",
		"-----XXX-X---XXX-X--",
		"-----X-X--XX--X-XXX-",
		"----X-XX--X-X-XXXXX-",
		"-----XXXXX-X---X--XX",
		"---X-XXXXX-----X---X",
		"-X--XXXX-X------XXXX",
		"XXX--X-XX-------XXX-",
		"---------------XXXX-",
		"-------------XX--X--",
		"-----------XX-XXX---",
		"------------X-XXXX--",
		"------------X-XXXX--",
		"-----------XX-XXX---",
		"-------------XX--X--",
		"---------------XXXX-",
		"XXX--X-XX-------XXX-",
		"-X--XXXX-X------XXXX",
		"---X-XXXXX-----X---X",
		"-----XXXXX-X---X--XX",
		"----X-XX--X-X-XXXXX-",
		"-----X-X--XX--X-XXX-",
		"-----XXX-X---XXX-X--",
		"-------X----X-------",
		"------------X-------"
      ],
      button: undefined
    },
	{
      name: "Laddership", // (My name, catalogued name is unnamed)
	  titleText: "Spaceship, c/2",
      category: "Day and Night",
      code: [
        "------------------------------------------XX-",
		"----------------------------------------XXX-X",
		"----------------------------------------X-XXX",
		"------------------------------------------X-X",
		"--X--X-X---X--X-X---X--X-X---X--X-X---XXX-XX-",
		"X-XX--XXXX-XX--XXXX-XX--XXXX-XX--XXXX-X-X----",
		"--X--X-X---X--X-X---X--X-X---X--X-X---XXXX---",
		"-----------------------------------------X---",
		"----------------------------------------X-XX-",
		"-----------------------------------------XXXX",
		"-----------------------------------------XXX-",
		"----------------------------------------X-X--"
      ],
      button: undefined
    },
	{
      name: "Rocket",
	  titleText: "Spaceship, c/2 (20c/40)",
      category: "Day and Night",
      code: [
        "-----------------------XX---X--X-------",
		"--XXX-------XXX--------XXX---XX--XX----",
		"XXXX-X--------X--XX---X-XXXXXXXXXX-XX--",
		"XXXXX---XXX--XXXXXXXX--XXXXXXXXXXXXXXX-",
		"-XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",
		"XXXXX---XXX--XXXXXXXX--XXXXXXXXXXXXXXX-",
		"XXXX-X--------X--XX---X-XXXXXXXXXX-XX--",
		"--XXX-------XXX--------XXX---XX--XX----",
		"-----------------------XX---X--X-------"
      ],
      button: undefined
    },
	{
      name: "Fireball",
	  titleText: "Spaceship, c/2 (20c/40)",
      category: "Day and Night",
      code: [
        "---------------------XX--------------------XX------",
		"-----------------X-XXX-X---------------XX-XXXX-----",
		"---XX-----------X-XXXXX-XX-------------XXXXXXX-X---",
		"-X---X----------XXXXXXXX-XX--X--XXX---X-XXXXXXXXX--",
		"XX---X-----------XXXXXXXXXX--XXX-X--X--XXXXXXXXXXX-",
		"----XX----------X-XXXXXXXXX----XXXXXXXXXXXXXXXXXXXX",
		"-----------------XXXXXXXXXXX-XXXXXXXXXXXXXXXXXXXXXX",
		"--------------XXXXXXXX-XXXXXXXX--XXXXXXXX-XXXXXXXX-",
		"----------------XXXX-XXX----X---X-XXXXX----XXXXXX--",
		"----------------X--X-X--X-----------X------XXXXX---",
		"-----------------XX--XX---------XX-X-------XX-X----"
      ],
      button: undefined
    },
	{
      name: "Ricochet", // (My name, catalogued name is unnamed)
	  titleText: "Oscillator, p36",
      category: "Day and Night",
      code: [
        "--XXX",
		"--XXX",
		"X-XXX",
		"X----",
		"XXX--",
      ],
      button: undefined
    },
	{
      name: "Fission Reactor", // (My name, catalogued name is unnamed)
	  titleText: "Oscillator, p9",
      category: "Day and Night",
      code: [
        "--X-------X--",
		"-X-X-----X-X-",
		"X-X-X---X-X-X",
		"-X-XX-X-XX-X-",
		"--XXXXXXXXX--",
		"----XXXXX----",
		"---XXXXXXX---",
		"----XXXXX----",
		"--XXXXXXXXX--",
		"-X-XX-X-XX-X-",
		"X-X-X---X-X-X",
		"-X-X-----X-X-",
		"--X-------X--"
      ],
      button: undefined
    },
	{
      name: "Corn on the Cob", // (My name, catalogued name is unnamed)
	  titleText: "Oscillator, p15",
      category: "Day and Night",
      code: [
        "----X------",
		"XX-X-----XX",
		"XXXXXXXXXXX",
		"-XXXXXXXXX-",
		"XXXXXXXXXXX",
		"XX-----X-XX",
		"------X----"
      ],
      button: undefined
    },
	{
      name: "Neuron", // (My name, catalogued name is unnamed)
	  titleText: "Oscillator, p11",
      category: "Day and Night",
      code: [
        "----XX-X--",
		"----X-X-X-",
		"----XXXXXX",
		"----XXXXX-",
		"-XXXXX----",
		"XXXXXX----",
		"-X-X-X----",
		"--X-XX----"
      ],
      button: undefined
    },
	
	// 2x2
	
	{
      name: "Sprinkler", // (My name, catalogued name is unnamed) (Credit to Nathaniel Johnston)
	  titleText: "Spaceship, c/8",
      category: "2x2",
      code: [
        "---X-",
		"X--XX",
		"-XXX-",
		"--X--"
      ],
      button: undefined
    },
	{
      name: "Twin Engine", // (My name, catalogued name is unnamed) (Credit to Nathaniel Johnston)
	  titleText: "Spaceship, c/4",
      category: "2x2",
      code: [
        "------X-X----",
		"-------XX----",
		"------XXXX---",
		"-------------",
		"-------------",
		"---------XXXX",
		"X-X---------X",
		"-XX-----X----",
		"XXX----X-XXX-",
		"--X--X--X-X--",
		"-----X--XX---",
		"-----X--X----",
		"-----XX------"
      ],
      button: undefined
    },
	{
      name: "Tortoise", // (My name, catalogued name is unnamed) (Credit to Nathaniel Johnston)
	  titleText: "Spaceship, c/3",
      category: "2x2",
      code: [
        "---XX-------",
		"-X--X--XX---",
		"XXX---X--X--",
		"X--X-X----X-",
		"------XX----",
		"---X-------X",
		"---------X-X",
		"---X-------X",
		"------XX----",
		"X--X-X----X-",
		"XXX---X--X--",
		"-X--X--XX---",
		"---XX-------"
      ],
      button: undefined
    },
	{
      name: "Scarabs", // (My name, catalogued name is unnamed) (Credit to Nathaniel Johnston)
	  titleText: "Spaceship, c/3",
      category: "2x2",
      code: [
        "-X---------",
		"XXX----XXX-",
		"-X-X-X-----",
		"-X-X-XXXXXX",
		"XXX--XXXXXX",
		"-X---X-----",
		"-------XXX-"
      ],
      button: undefined
    },
	{
      name: "Cocktail Shaker", // (My name, unknown if in the catalogue) (p22)
	  titleText: "Oscillator, p22",
      category: "2x2",
      code: [
        "XX--XX",
		"------",
		"--XX--",
		"-X--X-",
		"-X--X-"
      ],
      button: undefined
    },
	
	// Flock
	
	{
      name: "Moth", // (My name, catalogued name is unnamed)
	  titleText: "Spaceship, c/4 (2c/8)",
      category: "Flock",
      code: [
        "---------X-",
		"----------X",
		"------X----",
		"-----XXXXXX",
		"------XXXX-",
		"---X--XXX--",
		"--XXXX-----",
		"---XXX-----",
		"---XXX-----",
		"X--XX------",
		"-X-X-------"
      ],
      button: undefined
    },
	{
      name: "Apollo", // (My name, catalogued name is unnamed)
	  titleText: "Spaceship, c/4",
      category: "Flock",
      code: [
        "----------X-X-",
		"---X---------X",
		"---XX---X----X",
		"-----X----X-XX",
		"XXXXX-----X---",
		"-X-X--X-------",
		"-----X---X----",
		"-XX--X--X-----",
		"--------------",
		"-XX--X--X-----",
		"-----X---X----",
		"-X-X--X-------",
		"XXXXX-----X---",
		"-----X----X-XX",
		"---XX---X----X",
		"---X---------X",
		"----------X-X-"
      ],
      button: undefined
    },
	{
      name: "Artemis", // (My name, catalogued name is unnamed)
	  titleText: "Spaceship, c/4",
      category: "Flock",
      code: [
        "--XX-------",
		"-----XX----",
		"-X-----X---",
		"X----------",
		"-X----X--X-",
		"-----X-X--X",
		"--XX----X-X",
		"--------XXX",
		"-----------",
		"--------XXX",
		"--XX----X-X",
		"-----X-X--X",
		"-X----X--X-",
		"X----------",
		"-X-----X---",
		"-----XX----",
		"--XX-------"
      ],
      button: undefined
    },
	{
      name: "Kronos", // (My name, catalogued name is unnamed)
	  titleText: "Spaceship, c/5",
      category: "Flock",
      code: [
        "---------XX------------------------------",
		"--------X---X-------------------X--------",
		"-------X--------------------X---X--------",
		"-------XXX--X-X-X-----------XXXX---------",
		"-------X---X------X----------X---X-------",
		"------X---X-----X--X--------------XX-----",
		"-----X----XX---X----X-------X-----X--X---",
		"----X-X--XXXX--------X---X--X--XX--X--X--",
		"----XX-XX--X--X------XXX---X---X----XXXX-",
		"XX------------X--X--X-X-----X------X----X",
		"-XX-X------------X-X--X--X-XX-XX----X----",
		"-XX-XXX------------X-----X------X------X-",
		"-XX-XXX------------X-----X------X------X-",
		"-XX-X------------X-X--X--X-XX-XX----X----",
		"XX------------X--X--X-X-----X------X----X",
		"----XX-XX--X--X------XXX---X---X----XXXX-",
		"----X-X--XXXX--------X---X--X--XX--X--X--",
		"-----X----XX---X----X-------X-----X--X---",
		"------X---X-----X--X--------------XX-----",
		"-------X---X------X----------X---X-------",
		"-------XXX--X-X-X-----------XXXX---------",
		"-------X--------------------X---X--------",
		"--------X---X-------------------X--------",
		"---------XX------------------------------"
      ],
      button: undefined
    },
	{
      name: "Hyperion", // (My name, catalogued name is unnamed)
	  titleText: "Spaceship, 2c/5",
      category: "Flock",
      code: [
        "-------X--------------------------------",
		"------X--XX-XX--------------------------",
		"-------X---XXXX-------------------------",
		"----------------------------------------",
		"---------------X------------------X-----",
		"-------X---X--X-------XX----X---X--X----",
		"----------XX---------X-----X-------X----",
		"X--------------XX---X------X-------X----",
		"XX---X---XXX--------XX-XXX---X-----X----",
		"--X--X--XX--X-----------XX--X-XXXXXX----",
		"------X-XX----XXX--X----XXX----X--X-----",
		"---XX--X------XXX-X--X--XXX-----XX------",
		"--X-XX--X------XX----------X----XX------",
		"--X---XX------------X--X----X---XX--XX--",
		"-------X-----------XXXXXX----------XXXX-",
		"--------X---------X-X----X--X-XX--------",
		"-------XX-----------X------------------X",
		"-------XX-----------X------------------X",
		"--------X---------X-X----X--X-XX--------",
		"-------X-----------XXXXXX----------XXXX-",
		"--X---XX------------X--X----X---XX--XX--",
		"--X-XX--X------XX----------X----XX------",
		"---XX--X------XXX-X--X--XXX-----XX------",
		"------X-XX----XXX--X----XXX----X--X-----",
		"--X--X--XX--X-----------XX--X-XXXXXX----",
		"XX---X---XXX--------XX-XXX---X-----X----",
		"X--------------XX---X------X-------X----",
		"----------XX---------X-----X-------X----",
		"-------X---X--X-------XX----X---X--X----",
		"---------------X------------------X-----",
		"----------------------------------------",
		"-------X---XXXX-------------------------",
		"------X--XX-XX--------------------------",
		"-------X--------------------------------"
      ],
      button: undefined
    },
	{
      name: "Dust Cloud", // (My name, catalogued name is unnamed)
	  titleText: "Oscillator, p7",
      category: "Flock",
      code: [
        "-X-X----",
		"----X---",
		"X--X----",
		"XXX-----",
		"--------",
		"-----XXX",
		"----X--X",
		"---X----",
		"----X-X-"
      ],
      button: undefined
    },
	{
      name: "Capacitor", // (My name, catalogued name is unnamed)
	  titleText: "Oscillator, p5",
      category: "Flock",
      code: [
		"-XX----X-------X----XX-",
		"X--X--X---------X--X--X",
		"-X---X-----------X---X-",
		"-----XX----X----XX-----",
		"---X---X---X---X---X---",
		"----XX-X-X---X-X-XX----",
		"----XXX---------XXX----",
		"----XX-X-X---X-X-XX----",
		"---X---X---X---X---X---",
		"-----XX----X----XX-----",
		"-X---X-----------X---X-",
		"X--X--X---------X--X--X",
		"-XX----X-------X----XX-"
      ],
      button: undefined
    },
	{
      name: "Hurricane", // (My name, catalogued name is unnamed)
	  titleText: "Oscillator, p9",
      category: "Flock",
      code: [
        "-------XX--------",
		"-----------------",
		"--------X--X-----",
		"-------XXXXX-----",
		"----X---XXXXX----",
		"--XXX------------",
		"---XX------------",
		"---XX--------X--X",
		"X-XXX-------XXX-X",
		"X--X--------XX---",
		"------------XX---",
		"------------XXX--",
		"----XXXXX---X----",
		"-----XXXXX-------",
		"-----X--X--------",
		"-----------------",
		"--------XX-------"
      ],
      button: undefined
    },
	
	// Diamoeba
	
	{
      name: "Slimer", // (My name, catalogued name is unnamed)
	  titleText: "Spaceship, c/16",
      category: "Diamoeba",
      code: [
        "--XXXXXXX----",
		"-XXXXXXXXX---",
		"--XXXXXXXXXX-",
		"-XXXXXXXXXX--",
		"--XXXXXXXXXXX",
		"XXXXXXXXXXX--",
		"--XXXXXXXXXXX",
		"-XXXXXXXXXX--",
		"--XXXXXXXXXX-",
		"-XXXXXXXXX---",
		"--XXXXXXX----"
      ],
      button: undefined
    },
	{
      name: "Snail", // (My name, catalogued name is unnamed)
	  titleText: "Spaceship, c/7",
      category: "Diamoeba",
      code: [
        "----X-XX-----------------",
		"----XXXX-X---------------",
		"--XXXXXXXXX------------X-",
		"--XXXXXXXXX--X---X-X-XX-X",
		"XXXXXXXXXXXX-X-X-X-XXXXX-",
		"XXXXXXXXXXXXXXXXXXXXXXXX-",
		"XXXXXXXXXXXXXXXXXXXXXXXX-",
		"XXXXXXXXXXXX-X-X-X-XXXXX-",
		"--XXXXXXXXX--X---X-X-XX-X",
		"--XXXXXXXXX------------X-",
		"----XXXX-X---------------",
		"----X-XX-----------------"
      ],
      button: undefined
    },
	
	// 34 Life
	
	{
      name: "Musketball", // (My name, catalogued name is "orthogonal glider" in the context of 34 Life)
	  titleText: "Spaceship, c/3",
      category: "34 Life",
      code: [
        "X-",
		"XX",
		"XX",
		"X-"
      ],
      button: undefined
    },
	{
      name: "Hang Glider", // (My name, catalogued name is unnamed)
	  titleText: "Spaceship, c/3",
      category: "34 Life",
      code: [
        "-X--",
		"X--X",
		"--XX",
		"-XXX"
      ],
      button: undefined
    },
	{
      name: "Bumblebee", // (My name, catalogued name is unnamed)
	  titleText: "Spaceship, c/3",
      category: "34 Life",
      code: [
        "XXXX",
		"---X",
		"X--X",
		"-XXX",
		"-X--"
      ],
      button: undefined
    },
	{
      name: "Flatfish", // (My name, catalogued name is unnamed) (I have plenty of spaceships for this rule but I finally found one that wasn't c/3)
	  titleText: "Spaceship, c/7",
      category: "34 Life",
      code: [
        "-X----XXX--",
		"-XX--X---X-",
		"---XX-----X",
		"-X-XX-----X",
		"X----X----X",
		"-X-XX-----X",
		"---XX-----X",
		"-XX--X---X-",
		"-X----XXX--"
      ],
      button: undefined
    },
	{
      name: "Totem Pole", // (My name, catalogued name is unnamed)
	  titleText: "Spaceship, c/3",
      category: "34 Life",
      code: [
        "-X----------------------",
		"-X-------XX-X-X-XXX--X--",
		"X-XX-X-X-X-XXX--X---XX-X",
		"-X-X-XXX--X-XXX-----XXXX",
		"-X-X-XXX--X-XXX-----XXXX",
		"X-XX-X-X-X-XXX--X---XX-X",
		"-X-------XX-X-X-XXX--X--",
		"-X----------------------"
      ],
      button: undefined
    },
	{
      name: "Crownship", // (My name, catalogued name is unnamed)
	  titleText: "Spaceship, c/2",
      category: "34 Life",
      code: [
        "-----X-XX---",
		"--X-XX--XX--",
		"--XXX-X--X--",
		"-X-X-X--XXX-",
		"-X--X-----X-",
		"--XXX-----XX",
		"X--X----X-XX",
		"XXXX----XXX-",
		"--X---------",
		"-X------XXX-",
		"--X-------XX",
		"XXXX------XX",
		"X--X----XXX-",
		"--XXX-------",
		"X--X----XXX-",
		"XXXX------XX",
		"--X-------XX",
		"-X------XXX-",
		"--X---------",
		"XXXX----XXX-",
		"X--X----X-XX",
		"--XXX-----XX",
		"-X--X-----X-",
		"-X-X-X--XXX-",
		"--XXX-X--X--",
		"--X-XX--XX--",
		"-----X-XX---"
      ],
      button: undefined
    },
	{
      name: "Tiki Mask", // (My name, catalogued name is unnamed)
	  titleText: "Spaceship, c/3",
      category: "34 Life",
      code: [
        "-------------X-X--------------",
		"------X-X-X-X-XX---X----------",
		"-----XX-XX-XXX--XX-XXX--------",
		"--XX---XXX-X-XXXX-XXXX-XX-----",
		"----XX--XX-XXX---XXX-X-X-XXX--",
		"--XXXXX-XX-XX--XXX-X-X--XXXXX-",
		"XX--XX--XX--XX-XX--X-XX---X--X",
		"-XX--XXXXX----------------X--X",
		"XX--XX--XX--XX-XX--X-XX---X--X",
		"--XXXXX-XX-XX--XXX-X-X--XXXXX-",
		"----XX--XX-XXX---XXX-X-X-XXX--",
		"--XX---XXX-X-XXXX-XXXX-XX-----",
		"-----XX-XX-XXX--XX-XXX--------",
		"------X-X-X-X-XX---X----------",
		"-------------X-X--------------"
      ],
      button: undefined
    },
	{
      name: "Firecracker", // (My name, catalogued name is unnamed)
	  titleText: "Oscillator, p20",
      category: "34 Life",
      code: [
        "XXX---",
		"X-X---",
		"XXX---",
		"---XXX",
		"---X-X",
		"---XXX"
      ],
      button: undefined
    },
	{
      name: "Morningstar", // (My name, catalogued name is unnamed)
	  titleText: "Oscillator, p10",
      category: "34 Life",
      code: [
        "-X-X--",
		"---X-X",
		"XX----",
		"----XX",
		"X-X---",
		"--X-X-"
      ],
      button: undefined
    },
    
    // Shapes
    {
      name: "Rectangle",
	  titleText: "Shape",
      category: "Shapes",
      code: [],
      button: undefined
    },
    {
      name: "X",
	  titleText: "Shape",
      category: "Shapes",
      code: [],
      button: undefined
    },
    {
      name: "Cross",
	  titleText: "Shape",
      category: "Shapes",
      code: [],
      button: undefined
    },
	{
      name: "Static",
	  titleText: "Shape",
      category: "Shapes",
      code: [],
      button: undefined
    },
	{
      name: "Eraser",
	  titleText: "Shape",
      category: "Shapes",
      code: [],
      button: undefined
    }
  ];
  
  function generateShapeStruct(name) {
    // Returns an array of strings of X's and -'s like a structure code, to generate a structure for shapes of different sizes
    
    let code = [];
    
    if (name === "Rectangle") {
      for (let y = 0; y < shapeStructHeight; y++) {
        let row = "";
        for (let x = 0; x < shapeStructWidth; x++) {
          if (shapeStructFill === 0) { // If only drawing with an outline:
            // If we're on an edge, draw a cell
            let isEdge = x === 0 || x === shapeStructWidth - 1 || y === 0 || y === shapeStructHeight - 1;
            row += isEdge ? "X" : "-";
          }
          else if (shapeStructFill === 1) { // If drawing a solid shape:
            // Literally just always draw a cell at every position within the size
            row += "X";
          }
        }
        code.push(row);
      }
    }
    
    if (name === "X") {
      for (let y = 0; y < shapeStructLength; y++) {
        let row = "";
        for (let x = 0; x < shapeStructLength; x++) {
          if (shapeStructFill === 0) { // If only drawing with an outline:
            let isEdge = x === 0 || x === shapeStructLength - 1 || y === 0 || y === shapeStructLength - 1;
            let onDiagonal = false;
            // If we're on an edge, being on the diagonal is counted as long as its in-between the two edges of the diagonal stripes
            if (isEdge) onDiagonal = (Math.abs(x - y) <= shapeStructThickness - 1) || (Math.abs((shapeStructLength - x - 1) - y) <= shapeStructThickness - 1);
            // Otherwise, you need to be directly on one of the two edges of the diagonal stripes
            // This way, we get a hollow x-shape but the corners still close up normally
            else {
              onDiagonal = (Math.abs(x - y) === shapeStructThickness - 1) || (Math.abs((shapeStructLength - x - 1) - y) === shapeStructThickness - 1);
              if ((Math.abs(x - y) < shapeStructThickness - 1) || (Math.abs((shapeStructLength - x - 1) - y) < shapeStructThickness - 1)) onDiagonal = false;
            }
            row += onDiagonal ? "X" : "-"; // Draw a cell only on the diagonal
          }
          else if (shapeStructFill === 1) { // If drawing a solid shape:
            // Draw a cell as long as we're in-between the two edges of the diagonal stripes
            let onDiagonal = (Math.abs(x - y) <= shapeStructThickness - 1) || (Math.abs((shapeStructLength - x - 1) - y) <= shapeStructThickness - 1);
            row += onDiagonal ? "X" : "-";
          }
        }
        code.push(row);
      }
    }
    
    if (name === "Cross") {
      for (let y = 0; y < shapeStructHeight; y++) {
        let row = "";
        for (let x = 0; x < shapeStructWidth; x++) {
          if (shapeStructFill === 0) { // If only drawing with an outline:
            let isEdge = x === 0 || x === shapeStructWidth - 1 || y === 0 || y === shapeStructHeight - 1;
            let onCross = false;
            // If we're on an edge, being on the cross-shape is counted as long as its in-between the two edges of the orthogonal stripes
            if (isEdge) onCross = Math.abs(x - Math.floor(shapeStructWidth / 2)) <= shapeStructThickness - 1 || Math.abs(y - Math.floor(shapeStructHeight / 2)) <= shapeStructThickness - 1;
            // Otherwise, you need to be directly on one of the two edges of the orthogonal stripes
            // This way, we get a hollow cross-shape but the edges still close up normally
            else {
              onCross = Math.abs(x - Math.floor(shapeStructWidth / 2)) === shapeStructThickness - 1 || Math.abs(y - Math.floor(shapeStructHeight / 2)) === shapeStructThickness - 1;
              if (Math.abs(x - Math.floor(shapeStructWidth / 2)) < shapeStructThickness - 1 || Math.abs(y - Math.floor(shapeStructHeight / 2)) < shapeStructThickness - 1) onCross = false;
            }
            row += onCross ? "X" : "-";
          }
          else if (shapeStructFill === 1) { // If drawing a solid shape:
            // Draw a cell as long as we're in-between the two edges of the orthogonal stripes
            onCross = Math.abs(x - Math.floor(shapeStructWidth / 2)) <= shapeStructThickness - 1 || Math.abs(y - Math.floor(shapeStructHeight / 2)) <= shapeStructThickness - 1;
            row += onCross ? "X" : "-";
          }
        }
        code.push(row);
      }
    }
	
	if (name === "Eraser") {
	  for (let y = 0; y < shapeStructHeight; y++) {
        let row = "";
        for (let x = 0; x < shapeStructWidth; x++) {
          row += "-"; // Fill only with empty cells
        }
        code.push(row);
      }
	}
	
	if (name === "Static") {
	  if (shapeStructSymmetry === 0) { // Asymmetric
	    for (let y = 0; y < shapeStructHeight; y++) {
          let row = "";
          for (let x = 0; x < shapeStructWidth; x++) {
            row += Math.random() < shapeStructRandomDensity ? "X" : "-"; // Fill randomly with empty/live cells
          }
          code.push(row);
        }
	  }
	  else if (shapeStructSymmetry === 1) { // 1-Way Symmetry
	    // Make full grid of random static like usual
	    for (let y = 0; y < shapeStructHeight; y++) {
          let row = "";
          for (let x = 0; x < shapeStructWidth; x++) {
            row += Math.random() < shapeStructRandomDensity ? "X" : "-"; // Fill randomly with empty/live cells
          }
          code.push(row);
        }
		
		// Then go through the left half of the grid and mirror it to the right half
		for (let y = 0; y < shapeStructHeight; y++) {
		  for (let x = 0; x < Math.floor(shapeStructWidth / 2) + 1; x++) {
	        code[y] = code[y].replaceAt(x, code[y][shapeStructWidth - x - 1]);
		  }
		}
	  }
	  else if (shapeStructSymmetry === 2) { // 2-Way Symmetry
	    // Make full grid of random static like usual
	    for (let y = 0; y < shapeStructHeight; y++) {
          let row = "";
          for (let x = 0; x < shapeStructWidth; x++) {
            row += Math.random() < shapeStructRandomDensity ? "X" : "-"; // Fill randomly with empty/live cells
          }
          code.push(row);
        }
		
		// Then go through the top left half of the grid and mirror it to the top right half
		for (let y = 0; y < Math.floor(shapeStructHeight / 2) + 1; y++) {
		  for (let x = 0; x < Math.floor(shapeStructWidth / 2) + 1; x++) {
	        code[y] = code[y].replaceAt(x, code[y][shapeStructWidth - x - 1]);
		  }
		}
		
		// Then go through the top half of the grid and mirror it to the bottom half
		for (let y = 0; y < Math.floor(shapeStructHeight / 2) + 1; y++) {
		  code[shapeStructHeight - y - 1] = code[y];
		}
	  }
	}
    
    return code;
  }
  
  function lifeLexiconToStruct(str) {
    // Used solely in the console
    // I can copy and paste the plaintext from Life Lexicon and convert it to a style where I can directly copy and paste it into my code
    
    let arr = str.replaceAll(" ", "").replaceAll("\t", "").replaceAll(".", "-").replaceAll("O", "X").split("\n");
    
    let win = window.open();
    win.document.body.style.fontFamily = "monospace";
    for (let i = 0; i < arr.length; i++) {
      win.document.body.innerHTML += "\"";
      win.document.body.innerHTML += arr[i];
      win.document.body.innerHTML += "\"";
      if (i !== arr.length - 1) win.document.body.innerHTML += ",<br>";
    }
  }
  function rleToStruct(str) {
    // Used solely in the console
    // Converts a .rle (run length encoded) string to text I can copy and paste to a structure object
    
    let longestRow = 0;
    let rleArr = str.replaceAll("!", "").replaceAll("\n", "").split("$");
    let nextArr = [];
    
    let y = 0;
    while (y < rleArr.length) {
      let currString = "";
      let row = rleArr[y] + "$";
      let x = 0;
      let numString = "";
      while (x < row.length) {
        numString = "";
        while (!Number.isNaN(Number(row[x]))) { // While current index is a digit character
          numString += String(row[x]);
          x++;
        }
        if (numString === "") numString = "1";
        if (row[x] === "b") {
          for (let i = 0; i < Number(numString); i++) currString += "-";
        }
        else if (row[x] === "o") {
          for (let i = 0; i < Number(numString); i++) currString += "X";
        }
        else if (row[x] === "$") {
          for (let i = 0; i < Number(numString) - 1; i++) {
            nextArr.push(currString);
            currString = "";
          }
          x = row.length;
        }
        
        x++;
      }
      y++;
      nextArr.push(currString);
      longestRow = Math.max(currString.length, longestRow);
    }
    
    for (let i = 0; i < nextArr.length; i++) nextArr[i] = nextArr[i].padEnd(longestRow, "-");
    
    lifeLexiconToStruct(nextArr.join("\n"));
  }
  function codeToCopyPaste(code) {
    // Takes a structCode (array of strings) and opens a new window with data to copy-paste into the structure array's code
    
    lifeLexiconToStruct(code.join("\n"));
  }
  function loadRuleString(str) {
    // Given a rulestring like "b3s23", load that rule
	
	str = str.toLowerCase().replaceAll("/", "");
	
	let rule = str.split("s");
	rule[0] = rule[0].replace("b", "");
	
	let b = [];
	for (let i = 0; i < rule[0].length; i++) b.push(Number(rule[0][i]));
	
	
	let s = [];
	for (let i = 0; i < rule[1].length; i++) s.push(Number(rule[1][i]));
	
	setRules(b, s);
  }
  
  function doStructsHaveDuplicateNames() {
    // A debugging function used only to make sure no structures share a name
	
	let duplicates = [];
	
	for (let i = 0; i < structures.length; i++) {
	  let iName = structures[i].name.toLowerCase().replaceAll(" ", "");
	  for (let j = 0; j < structures.length; j++) {
	    let jName = structures[j].name.toLowerCase().replaceAll(" ", "");
		if (iName === jName && i !== j) duplicates.push(iName);
	  }
	}
	
	return duplicates.length === 0 ? "no duplicates found" : duplicates;
  }
  
  String.prototype.replaceAt = function(index, replacement) {
    return this.substring(0, index) + replacement + this.substring(index + replacement.length);
  };
  
  function mirrorCode(axis) {
    // Mutates structCode so that it is mirrored about the given axis
    
    let flipCode = [];
    
    let width = structCode[0].length;
    let height = structCode.length;
    
    for (let y = 0; y < height; y++) flipCode.push(structCode[y]);
    
    if (axis === "y") {
      for (let y = 0; y < height; y++) {
        for (let x = 0; x < width; x++) {
          flipCode[y] = flipCode[y].replaceAt(x, structCode[y][width - x - 1]);
        }
      }
    }
    
    else if (axis === "x") {
      for (let x = 0; x < width; x++) {
        for (let y = 0; y < height; y++) {
          flipCode[y] = flipCode[y].replaceAt(x, structCode[height - y - 1][x]);
        }
      }
    }
    
    structCode = flipCode;
  }
  
  function flipXYCode() {
    // Mutates structCode so that every x and y are swapped (and, consequently, width and height are swapped as well)
    
    let flipCode = [];
    
    structWidth = structCode.length;
    structHeight = structCode[0].length;
    
    for (let x = 0; x < structHeight; x++) {
      let row = "";
      for (let y = 0; y < structWidth; y++) {
        row += structCode[y][x];
      }
      flipCode.push(row);
    }
    
    structWidth = structCode.length;
    structHeight = structCode[0].length;
    
    structCode = flipCode;
  }
  
  function loadRandomStruct() {
    // Randomly chooses a structure to place in the middle of the grid
    
    let validStructs = [];
    for (let i = 0; i < structures.length; i++) {
      let s = structures[i];
      
      // Ignore Shapes and structures that are too large
      if (s.category === "Game of Life") {
        let valid = true;
        valid &&= s.code.length <= 50;
        valid &&= s.code[0].length <= 50;
        //valid &&= s.code.length >= 7 || s.code[0].length >= 7;
        if (valid) validStructs.push(i);
        //else console.log(s);
      }
    }
    
    clearGrid();
    
    let chosenIndex = validStructs[Math.floor(Math.random() * validStructs.length)]; // Choose random valid structure
    
    // Select it, place it, deselect it
    initStruct(chosenIndex);
    placeStruct(Math.floor(gridSize / 2), Math.floor(gridSize / 2));
    initStruct(chosenIndex);
  }
  
  function initShapeStruct(n) {
    // Given an index of a shape structure, update the preset's code accordingly, and hide/show various shape settings
	
    let preset = structures[n];
	
	if (preset.name === "Rectangle") {
	  preset.code = generateShapeStruct(preset.name);
	  
	  shapeWidthDiv.style.display = "block";
	  shapeHeightDiv.style.display = "block";
	  shapeLengthDiv.style.display = "none";
	  shapeThicknessDiv.style.display = "none";
	  shapeRandomDensityDiv.style.display = "none";
	  shapeFillDiv.style.display = "block";
	  shapeSymmetryDiv.style.display = "none";
	}
	if (preset.name === "X") {
	  preset.code = generateShapeStruct(preset.name);
	  
	  shapeWidthDiv.style.display = "none";
	  shapeHeightDiv.style.display = "none";
	  shapeLengthDiv.style.display = "block";
	  shapeThicknessDiv.style.display = "block";
	  shapeRandomDensityDiv.style.display = "none";
	  shapeFillDiv.style.display = "block";
	  shapeSymmetryDiv.style.display = "none";
	}
	if (preset.name === "Cross") {
	  preset.code = generateShapeStruct(preset.name);
	  
	  shapeWidthDiv.style.display = "block";
	  shapeHeightDiv.style.display = "block";
	  shapeLengthDiv.style.display = "none";
	  shapeThicknessDiv.style.display = "block";
	  shapeRandomDensityDiv.style.display = "none";
	  shapeFillDiv.style.display = "block";
	  shapeSymmetryDiv.style.display = "none";
	}
	if (preset.name === "Eraser") {
	  preset.code = generateShapeStruct(preset.name);
	  
	  shapeWidthDiv.style.display = "block";
	  shapeHeightDiv.style.display = "block";
	  shapeLengthDiv.style.display = "none";
	  shapeThicknessDiv.style.display = "none";
	  shapeRandomDensityDiv.style.display = "none";
	  shapeFillDiv.style.display = "none";
	  shapeSymmetryDiv.style.display = "none";
	}
	if (preset.name === "Static") {
	  preset.code = generateShapeStruct(preset.name);
	  
	  shapeWidthDiv.style.display = "block";
	  shapeHeightDiv.style.display = "block";
	  shapeLengthDiv.style.display = "none";
	  shapeThicknessDiv.style.display = "none";
	  shapeRandomDensityDiv.style.display = "block";
	  shapeFillDiv.style.display = "none";
	  shapeSymmetryDiv.style.display = "block";
	}
  }
  
  function initStruct(n) {
    // When a structure button is clicked, enter structure placing mode
    
    if (n !== -1) {
      // Set up structure information variables
      
      let preset = structures[n];
	  let name = preset.name;
      
      if (preset.category === "Shapes") {
        // If drawing a shape, go through and enable/disable various setting sliders based on which shape is selected
          
        initShapeStruct(n);
      }
      
      placingStruct = true;
      structCode = preset.code;
      structWidth = preset.code[0].length;
      structHeight = preset.code.length;
      
      exitPlacingBtn.style.visibility = structureNameTxt.style.visibility = "visible"; // Show Exit Placing button
      structureNameTxt.innerHTML = "<b>(Placing: " + getStructName(n) + ")</b>";
	  structDescTxt.innerHTML = getStructName(n);
      
      document.getElementById("show-section-btn-a-2").click(); // Switch to structures tab
      
      if (preset.category === "Game of Life") document.getElementById("show-section-btn-b-1").click();
      if (preset.category === "Shapes") document.getElementById("show-section-btn-b-2").click();
    }
    
    // Disable all other structure buttons, but set this one to shown
    
    for (let i = 0; i < structures.length; i++) {
      let s = structures[i];
      
      if (i === n) { // Once a case is matched,
        if (structIndex === i) { // If the button that called this is already active, turn off Structure Placing Mode
          s.button.className = "structure-btn-inactive";
          placingStruct = false;
          exitPlacingBtn.style.visibility = structureNameTxt.style.visibility = "hidden";
          if (structIndex !== -1) lastStructIndex = structIndex;
          structIndex = -1; // -1 index means nothing is selected
          structureNameTxt.innerHTML = "";
        }
        else { // Otherwise, activate that button
          s.button.className = "structure-btn-active";
          if (structIndex !== -1) lastStructIndex = structIndex;
          structIndex = n;
          structureNameTxt.innerHTML = "<b>(Placing: " + getStructName(i) + ")</b>";
		  structDescTxt.innerHTML = getStructName(i);
        }
      }
      else s.button.className = "structure-btn-inactive";
    }
    
    if (n === -1) { // Inputting -1 to this function disables all structure buttons
      placingStruct = false;
      exitPlacingBtn.style.visibility = structureNameTxt.style.visibility = "hidden";
      if (structIndex !== -1) lastStructIndex = structIndex;
      structIndex = -1;
      structureNameTxt.innerHTML = "";
	  ctx.clearRect(0, 0, canvas.width, canvas.height); // Clear the canvas if deselecting a struct, so that the red zones disappear even if trailing is on
    }
    
	checkIfStructFits();
	
    if (structIndex !== -1) updateStruct();
    
    drawGrid();
	
	structCanvasPreview();
  }
  
  function getStructName(i) {
    // Returns the name of the structure at the given index, but formatted with more information if its a shape struct
	
	let s = structures[i];
	let name = "";
	
	if (s.category !== "Shapes") name = s.name; // Non-shape gets default name
	else { // Shapes get name with added description of characteristics
	  let fill = ["Outline", "Solid", "Striped"][shapeStructFill]; // Convert shapeStructFill to a string description of it
	  let symmetry = ["Asymmetric", "1-Way Symmetric", "2-Way Symmetric"][shapeStructSymmetry]; // Convert shapeStructSymmetry to a string description of it
	  
	  if (s.name === "Rectangle") name = `Rectangle &mdash; ${shapeStructWidth}&times;${shapeStructHeight}, ${fill}`;
      
	  else if (s.name === "X") name = `X &mdash; ${shapeStructLength} Long, ${shapeStructThickness} Thick, ${fill}`;
      
	  else if (s.name === "Cross") name = `Cross &mdash; ${shapeStructWidth}&times;${shapeStructHeight}, ${shapeStructThickness} Thick, ${fill}`;
	  
	  else if (s.name === "Eraser") name = `Eraser &mdash; ${shapeStructWidth}&times;${shapeStructHeight}`;
	  
	  else if (s.name === "Static") name = `${symmetry} Static &mdash; ${shapeStructWidth}&times;${shapeStructHeight}`;
	}
	
	return name;
  }
  
  function structCanvasPreview() {
    // Draws a preview of the current structure on structCanvas
	
	updateStruct();
	
	// Find the larger dimension of the current structure, and adjust the canvas's size to be a multiple of that size
	let largerSize = Math.max(structWidth, structHeight);
	structCanvas.width = structCanvas.height = largerSize * Math.round(structCanvasSize / largerSize);
	
	sctx.fillStyle = bgColor;
	sctx.fillRect(0, 0, structCanvas.width, structCanvas.height);
	sctx.fillStyle = cellColor;
	
	let tSize = structCanvas.width / largerSize; // tileSize
	
	let yOffset = largerSize - structHeight;
	
	// Draw structure preview
	for (let x = 0; x < structWidth; x++) {
	  for (let y = 0; y < structHeight; y++) {
		  if (structCode[y][x] === "X") sctx.fillRect(x * tSize, (y + yOffset) * tSize, tSize, tSize);
	  }
	}
	
	// Draw grid lines
	
	sctx.strokeStyle = gridLineColor;
	sctx.lineWidth = tSize * gridLineWidth;
	
	// Vertical lines
	for (let x = 0; x <= largerSize; x++) {
	  sctx.beginPath();
	  sctx.moveTo(x * tSize, 0);
	  sctx.lineTo(x * tSize, structCanvas.height);
	  sctx.stroke();
	}
	
	// Horizontal lines
	for (let y = 0; y <= largerSize; y++) {
	  sctx.beginPath();
	  sctx.moveTo(0, y * tSize);
	  sctx.lineTo(structCanvas.width, y * tSize);
	  sctx.stroke();
	}
	
	// Clear the portion of the grid that the structure doesn't reach
	
	if (structWidth < structHeight) {
	  sctx.clearRect(structWidth * tSize, 0, structCanvas.width, structCanvas.height);
	}
	else if (structHeight < structWidth) {
	  sctx.clearRect(0, 0, structCanvas.width, (largerSize - structHeight) * tSize);
	}
  }
  
  function togglePlacingStruct() {
    if (placingStruct) {
      Mouse.movedSinceLastClick = false;
      initStruct(-1); // If placing, exit placing
    }
    else {
      Mouse.movedSinceLastClick = true;
      initStruct(lastStructIndex); // Otherwise, enter placing mode with last selected structure
    }
  }
  
  function updateStruct() {
    // Mutates structCode to reflect the orientation of the currently selected structState
    
    structCode = structures[structIndex === -1 ? lastStructIndex : structIndex].code;
    structWidth = structCode[0].length;
    structHeight = structCode.length;
	
    switch(structState) {
      case 0: // Right-side up, 0deg
        break;
      
      case 1: // Right-side up, 90deg
        flipXYCode();
        mirrorCode("y");
        break;
      
      case 2: // Right-side up, 180deg
        flipXYCode();
        mirrorCode("y");
        flipXYCode();
        mirrorCode("y");
        break;
      
      case 3: // Right-side up, 270deg
        mirrorCode("y");
        flipXYCode();
        break;
      
      case 4: // Upside-down, 0deg
        mirrorCode("x");
        break;
      
      case 5: // Upside-down, 90deg
        mirrorCode("x");
        flipXYCode();
        mirrorCode("y");
        break;
      
      case 6: // Upside-down, 180deg
        mirrorCode("y");
        break;
      
      case 7: // Upside-down, 270deg
        mirrorCode("y");
        flipXYCode();
        mirrorCode("y");
        break;
    }
  }
  
  function previewStruct(gridX, gridY) {
    // Draw a translucent preview of the currently selected structure at the given position
    
    if (!isValidStructPlacement(gridX, gridY) || !structFitsOnGrid) return;
    
    let w2 = Math.floor(structWidth / 2);
    let h2 = Math.floor(structHeight / 2);
    let wOffset = (structWidth + 1) % 2;
    let hOffset = (structHeight + 1) % 2;
	
	let minX = 0 - w2 + wOffset + gridX;
	let minY = 0 - h2 + hOffset + gridY;
	let maxX = structWidth - 1 - w2 + wOffset + gridX;
	let maxY = structHeight - 1 - h2 + hOffset + gridY;
	
	let xOffset = 0;
	let yOffset = 0;
	
	// This code "scoots" the structure so that if it's beyond the edge, it moves to be touching the edge
	if (minX < 0) xOffset = -minX;
	if (maxX >= gridSize) xOffset = gridSize - maxX - 1;
	if (minY < 0) yOffset = -minY;
	if (maxY >= gridSize) yOffset = gridSize - maxY - 1;
    
    tctx.clearRect(0, 0, canvas.width, canvas.height);
    tctx.fillStyle = cellColor;
    tctx.globalAlpha = 0.5;
    
    for (let x = 0; x < structWidth; x++) {
      for (let y = 0; y < structHeight; y++) {
        let _x = x - w2 + wOffset + gridX;
        let _y = y - h2 + hOffset + gridY;
        
        if (x === 0 && y === 0) drawOneCell(_x + xOffset, _y + yOffset, 0, 1, tctx);
        drawOneCell(_x + xOffset, _y + yOffset, structCode[y][x] === "X" ? 1 : 0, 0.5, tctx);
      }
    }
    
    tctx.globalAlpha = 1;
    
    // Draw grid lines above cells (on top-canvas)
    if (showGridLines) {
      tctx.strokeStyle = gridLineColor;
      tctx.lineWidth = Math.max(1, (tileSize * gridLineWidth).toMultipleOf(2)); // Make line width an even number to reduce blurring
      
      // Vertical lines
      for (let x = 0; x <= gridSize; x++) {
        tctx.beginPath();
        tctx.moveTo(x * tileSize, 0);
        tctx.lineTo(x * tileSize, canvas.height);
        tctx.stroke();
      }
      
      // Horizontal lines
      for (let y = 0; y <= gridSize; y++) {
        tctx.beginPath();
        tctx.moveTo(0, y * tileSize);
        tctx.lineTo(canvas.width, y * tileSize);
        tctx.stroke();
      }
    }
  }
  
  function placeStruct(gridX, gridY) {
    // Copies the current structure pattern onto the grid, centered at the given position
	
	if (!structFitsOnGrid || !isValidStructPlacement(gridX, gridY)) return; // Don't place if the current struct is too big to fit anywhere on the grid
    
    Mouse.movedSinceLastClick = false; // Set this flag to false, which means the struct preview won't be redrawn until the mouse is moved
	// This ensures the user can actually see the structure they just placed, instead of it getting immediately covered up by a preview
    
    if (!isValidStructPlacement(gridX, gridY)) return;
    
    let w2 = Math.floor(structWidth / 2);
    let h2 = Math.floor(structHeight / 2);
    let wOffset = (structWidth + 1) % 2;
    let hOffset = (structHeight + 1) % 2;
	
	let minX = 0 - w2 + wOffset + gridX;
	let minY = 0 - h2 + hOffset + gridY;
	let maxX = structWidth - 1 - w2 + wOffset + gridX;
	let maxY = structHeight - 1 - h2 + hOffset + gridY;
	
	let xOffset = 0;
	let yOffset = 0;
	
	// This code "scoots" the structure so that if it's beyond the edge, it moves to be touching the edge
	if (minX < 0) xOffset = -minX;
	if (maxX >= gridSize) xOffset = gridSize - maxX - 1;
	if (minY < 0) yOffset = -minY;
	if (maxY >= gridSize) yOffset = gridSize - maxY - 1;
    
    for (let x = 0; x < structWidth; x++) {
      for (let y = 0; y < structHeight; y++) {
        let _x = x - w2 + wOffset + gridX;
        let _y = y - h2 + hOffset + gridY;
        
        grid[_x + xOffset][_y + yOffset] = structCode[y][x] === "X" ? 1 : 0;
      }
    }
    
    // This is user input, so save last grid state
    setLastGrid();
    
    drawGrid();
	
	if (structures[structIndex].name === "Static") updateSettings(false, true);
  }
  
  function showSection(group, groupLength, number) {
    // Show the given HTML section, in a certain group
    
    for (let i = 1; i <= groupLength; i++) {
      let section = document.getElementById("section-" + group + "-" + i);
      let btn = document.getElementById("show-section-btn-" + group + "-" + i);
      if (i === number) { // Show selected section
        section.style.display = "block";
        btn.className = "section-btn-active";
      }
      else { // Hide others
        section.style.display = "none";
        btn.className = "section-btn-inactive";
      }
    }
  }
  
  function initHTML() {
    // Create preset buttons
    for (let i = 0; i < presets.length; i++) {
      presets[i].code = numberifyRule(presets[i].born, presets[i].survive);
      
      let btn = document.createElement("button");
      btn.id = "preset-btn-" + i;
      presets[i].button = btn;
      btn.innerHTML = presets[i].name;
      btn.className = "preset-btn";
      btn.onclick = () => loadPreset(i);
      document.getElementById(presets[i].category + "-presets-div").appendChild(btn);
    }
    
    // Create born checkboxes
    for (let i = 0; i <= 8; i++) {
      let ruleLabel = document.createElement("label");
      ruleLabel.className = "rule-label";
      
      let check = document.createElement("input");
      check.type = "checkbox";
      check.oninput = () => checksToRules();
      check.id = "born" + i;
      check.className = "no-margin-checkbox";
      ruleLabel.for = check.id;
      
      let br = document.createElement("br");
      
      let numDiv = document.createElement("div");
      numDiv.innerHTML = "<b>" + i + "</b>";
      
      ruleLabel.appendChild(check);
      ruleLabel.appendChild(br);
      ruleLabel.appendChild(numDiv);
      
      bornWithDiv.appendChild(ruleLabel);
    }
    
    // Create survive checkboxes
    for (let i = 0; i <= 8; i++) {
      let ruleLabel = document.createElement("label");
      ruleLabel.className = "rule-label";
      
      let check = document.createElement("input");
      check.type = "checkbox";
      check.oninput = () => checksToRules();
      check.id = "survive" + i;
      check.className = "no-margin-checkbox";
      ruleLabel.for = check.id;
      
      let br = document.createElement("br");
      
      let numDiv = document.createElement("div");
      numDiv.innerHTML = "<b>" + i + "</b>";
      
      ruleLabel.appendChild(check);
      ruleLabel.appendChild(br);
      ruleLabel.appendChild(numDiv);
      
      surviveWithDiv.appendChild(ruleLabel);
    }
    
    // Create structure buttons
    for (let i = 0; i < structures.length; i++) {
      let s = structures[i];
      let btn = document.createElement("button");
      btn.className = "structure-btn-inactive";
      btn.innerHTML = s.name;
      btn.onclick = () => initStruct(i);
      s.button = btn;
	  btn.title = s.titleText;
      
	  // Append button to specific tab based on which rule it is intended for
	  
      if (s.category === "Game of Life") document.getElementById(s.subcategory + "-structures-div").appendChild(btn);
      
      if (s.category === "Shapes") document.getElementById("shapes-structures-div").appendChild(btn);
	  
	  if (s.category === "Move") document.getElementById("move-structures-div").appendChild(btn);
	  
	  if (s.category === "Day and Night") document.getElementById("day-and-night-structures-div").appendChild(btn);
	  
	  if (s.category === "2x2") document.getElementById("2x2-structures-div").appendChild(btn);
	  
	  if (s.category === "Flock") document.getElementById("flock-structures-div").appendChild(btn);
	  
	  if (s.category === "Diamoeba") document.getElementById("diamoeba-structures-div").appendChild(btn);
	  
	  if (s.category === "34 Life") document.getElementById("34-life-structures-div").appendChild(btn);
    }
    
    // Create hotkey descriptions
    for (let i = 0; i < hotkeys.length; i++) {
      let h = hotkeys[i];
      
      let tr = document.createElement("tr");
      
      let td1 = document.createElement("td");
      let td2 = document.createElement("td");
      
      td1.style.minWidth = td2.style.minWidth = "0";
      td1.style.padding = td2.style.padding = "0";
      td1.style.textAlign = "right";
      
      let span = document.createElement("span");
      span.className = "hotkey-txt";
      span.innerHTML = h.key;
      td1.appendChild(span);
      tr.appendChild(td1);
      
      td2.innerHTML = h.desc;
      tr.appendChild(td2);
      
      document.getElementById("hotkey-table-" + h.category).appendChild(tr);
    }
    
    setRules([3], [2, 3]);
    
    loadRandomStruct();
    
    showSection("a", NUM_SECTIONS_A, 2);
    showSection("b", NUM_SECTIONS_B, 1);
    
    frame();
  }
</script>

<script>(()=>{let links=document.getElementsByTagName("link");for(let i=0;i<links.length;i++){links[i].href+="?v="+Math.random();}let scripts=document.getElementsByTagName("script");for(let i=0;i<scripts.length;i++){if(scripts[i].src!==""){scripts[i].src+="?v="+Math.random();}}})();</script>

</body>
</html>








